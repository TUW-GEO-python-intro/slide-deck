<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<title>File IO</title>
<link rel="stylesheet" href="../reveal.js/css/reveal.css"/>
<link rel="stylesheet" href="../reveal.js/css/theme/black.css" id="theme"/>
<link rel="stylesheet" href="../code_formatting.css"/>

<!-- If the query includes 'print-pdf', include the PDF print sheet -->
<script>
    if( window.location.search.match( /print-pdf/gi ) ) {
        var link = document.createElement( 'link' );
        link.rel = 'stylesheet';
        link.type = 'text/css';
        link.href = '../reveal.js/css/print/pdf.css';
        document.getElementsByTagName( 'head' )[0].appendChild( link );
    }
</script>
</head>
<body>
<div class="reveal">
<div class="slides">
<section id="sec-title-slide" data-background="" data-background-size="" data-background-repeat="" data-background-transition="">
<h1>File IO</h1> <h2></h2> <h2><a href="mailto:"></a></h2> <h2></h2>
</section>

<section>
<section id="slide-orgheadline1">
<h2 id="orgheadline1">File formats</h2>
<ul>
<li>ASCII</li>
<li>Binary</li>
<li>Numpy</li>
<li>Matlab</li>
<li>IDL</li>
<li>NetCDF</li>
<li>HDF5</li>
<li>Excel</li>
<li>Pickle - Python object serialization</li>

</ul>
</section>
</section>
<section>
<section id="slide-orgheadline6">
<h2 id="orgheadline6">ASCII</h2>
<ul>
<li>A text file in which each byte represents one character according to the ASCII
code.</li>
<li>Contrast with a binary file, in which there is no one-to-one mapping between
bytes and characters.</li>

</ul>
</section>
<section id="slide-orgheadline2">
<h3 id="orgheadline2">Python standard library</h3>
<p>
<a href="https://docs.python.org/2/tutorial/inputoutput.html">Input output routines</a>
</p>
<ul>
<li><code>open()</code>, <code>close()</code></li>
<li><code>read()</code>, <code>readline()</code>, <code>readlines()</code></li>
<li><code>write()</code>, <code>writelines()</code></li>

</ul>
</section>
<section id="slide-orgheadline3">
<h3 id="orgheadline3">Before we start</h3>
<div class="org-src-container">

<pre  class="src src-python"><span style="color: #A52A2A; font-weight: bold;">import</span> os

<span style="color: #0084C8; font-weight: bold;">f_dir</span> = os.path.join<span style="color: #707183;">(</span><span style="color: #4E9A06;">'.'</span>, <span style="color: #4E9A06;">'files'</span><span style="color: #707183;">)</span>
<span style="color: #A52A2A; font-weight: bold;">if</span> <span style="color: #A52A2A; font-weight: bold;">not</span> os.path.exists<span style="color: #707183;">(</span>f_dir<span style="color: #707183;">)</span>:
    <span style="color: #A52A2A; font-weight: bold;">try</span>:
        os.mkdir<span style="color: #707183;">(</span>f_dir<span style="color: #707183;">)</span>
        <span style="color: #A52A2A; font-weight: bold;">print</span><span style="color: #707183;">(</span><span style="color: #4E9A06;">"Created files folder"</span><span style="color: #707183;">)</span>
    <span style="color: #A52A2A; font-weight: bold;">except</span> <span style="color: #2F8B58; font-weight: bold;">OSError</span>:
        <span style="color: #0084C8; font-weight: bold;">f_dir</span> = <span style="color: #4E9A06;">''</span>
        <span style="color: #A52A2A; font-weight: bold;">print</span><span style="color: #707183;">(</span><span style="color: #4E9A06;">"Failed creating files folder"</span><span style="color: #707183;">)</span>
</pre>
</div>

<pre class="example">
&gt;&gt;&gt; &gt;&gt;&gt; ... ... ... ... ... ... ... Created files folder
</pre>

</section>
<section id="slide-orgheadline4">
<h3 id="orgheadline4">ASCII example 1</h3>
<div class="org-src-container">

<pre  class="src src-python"><span style="color: #0084C8; font-weight: bold;">filename</span> = os.path.join<span style="color: #707183;">(</span>f_dir, <span style="color: #4E9A06;">'example1.txt'</span><span style="color: #707183;">)</span>
<span style="color: #0084C8; font-weight: bold;">f</span> = <span style="color: #A020F0;">open</span><span style="color: #707183;">(</span>filename, <span style="color: #4E9A06;">'w'</span><span style="color: #707183;">)</span>
f.write<span style="color: #707183;">(</span><span style="color: #4E9A06;">"Hello World!"</span><span style="color: #707183;">)</span>
f.close<span style="color: #707183;">()</span>

<span style="color: #A52A2A; font-weight: bold;">with</span> <span style="color: #A020F0;">open</span><span style="color: #707183;">(</span>filename<span style="color: #707183;">)</span> <span style="color: #A52A2A; font-weight: bold;">as</span> f:
    <span style="color: #A52A2A; font-weight: bold;">print</span><span style="color: #707183;">(</span>f.read<span style="color: #7388d6;">()</span><span style="color: #707183;">)</span>
</pre>
</div>

<pre class="example">
&gt;&gt;&gt; &gt;&gt;&gt; &gt;&gt;&gt; &gt;&gt;&gt; ... ... Hello World!
</pre>

</section>
<section id="slide-orgheadline5">
<h3 id="orgheadline5">numpy</h3>
<ul>
<li><a href="http://docs.scipy.org/doc/numpy/reference/generated/numpy.fromregex.html">np.fromregex</a>: Construct an array from a text file, using regular expression
parsing.</li>
<li><a href="http://docs.scipy.org/doc/numpy/reference/generated/numpy.fromstring.html">np.fromstring</a>: A new 1-D array initialized from raw binary or text data in a
string.</li>
<li><a href="http://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.tofile.html">np.ndarray.tofile</a>: Write array to a file as text or binary (default).</li>

</ul>
</section>
</section>
<section>
<section id="slide-orgheadline12">
<h2 id="orgheadline12">CSV</h2>
<ul>
<li>A comma-separated values (CSV) file stores <b>tabular data</b> (numbers and text)
in plain-text form.</li>
<li>Plain text means that the file is a sequence of characters, with no data that
has to be interpreted as binary numbers.</li>
<li>A CSV file consists of any number of records, separated by line breaks of some
kind; each record consists of fields, separated by some other character or
string, most commonly a literal comma or tab.</li>
<li>Usually, all records have an identical sequence of fields.</li>

</ul>
</section>
<section id="slide-orgheadline7">
<h3 id="orgheadline7">Python standard library</h3>
<p>
<a href="https://docs.python.org/2/tutorial/inputoutput.html">Input output routines</a>
</p>
<ul>
<li><code>open()</code>, <code>close()</code></li>
<li><code>read()</code>, <code>readline()</code>, <code>readlines()</code></li>
<li><code>write()</code>, <code>writelines()</code></li>

</ul>
</section>
<section id="slide-orgheadline8">
<h3 id="orgheadline8">CSV example 1</h3>
<div class="org-src-container">

<pre  class="src src-python"><span style="color: #0084C8; font-weight: bold;">filename</span> = os.path.join<span style="color: #707183;">(</span>f_dir, <span style="color: #4E9A06;">'example1.csv'</span><span style="color: #707183;">)</span>

<span style="color: #A52A2A; font-weight: bold;">with</span> <span style="color: #A020F0;">open</span><span style="color: #707183;">(</span>filename, <span style="color: #4E9A06;">'w'</span><span style="color: #707183;">)</span> <span style="color: #A52A2A; font-weight: bold;">as</span> f:
    f.write<span style="color: #707183;">(</span><span style="color: #4E9A06;">"lon,lat,temperature\n"</span><span style="color: #707183;">)</span>
    <span style="color: #0084C8; font-weight: bold;">data</span> = <span style="color: #707183;">[</span><span style="color: #7388d6;">[</span><span style="color: #F5666D;">16</span>, <span style="color: #F5666D;">48</span>, <span style="color: #F5666D;">20</span><span style="color: #7388d6;">]</span>, <span style="color: #7388d6;">[</span><span style="color: #F5666D;">17</span>, <span style="color: #F5666D;">48</span>, <span style="color: #F5666D;">21</span><span style="color: #7388d6;">]</span>, <span style="color: #7388d6;">[</span><span style="color: #F5666D;">18</span>, <span style="color: #F5666D;">48</span>, <span style="color: #F5666D;">18</span><span style="color: #7388d6;">]</span><span style="color: #707183;">]</span>
    <span style="color: #A52A2A; font-weight: bold;">for</span> record <span style="color: #A52A2A; font-weight: bold;">in</span> data:
        f.writelines<span style="color: #707183;">(</span><span style="color: #4E9A06;">','</span>.join<span style="color: #7388d6;">(</span><span style="color: #A020F0;">map</span><span style="color: #909183;">(</span><span style="color: #A020F0;">str</span>, record<span style="color: #909183;">)</span><span style="color: #7388d6;">)</span><span style="color: #707183;">)</span>
        f.write<span style="color: #707183;">(</span><span style="color: #4E9A06;">"\n"</span><span style="color: #707183;">)</span>

<span style="color: #A52A2A; font-weight: bold;">with</span> <span style="color: #A020F0;">open</span><span style="color: #707183;">(</span>filename<span style="color: #707183;">)</span> <span style="color: #A52A2A; font-weight: bold;">as</span> f:
    <span style="color: #A52A2A; font-weight: bold;">for</span> record <span style="color: #A52A2A; font-weight: bold;">in</span> f.readlines<span style="color: #707183;">()</span>:
        <span style="color: #A52A2A; font-weight: bold;">print</span><span style="color: #707183;">(</span>record<span style="color: #707183;">)</span>
</pre>
</div>
<pre class="example">
&gt;&gt;&gt; ... ... ... ... ... ... &gt;&gt;&gt; ... ... ... lon,lat,temperature

16,48,20

17,48,21

18,48,18
</pre>
</section>
<section id="slide-orgheadline9">
<h3 id="orgheadline9">numpy</h3>
<ul>
<li><a href="http://docs.scipy.org/doc/numpy/reference/generated/numpy.savetxt.html">np.savetxt</a>: Save an array to a text file.</li>
<li><a href="http://docs.scipy.org/doc/numpy/reference/generated/numpy.loadtxt.html">np.loadtxt</a>: Load data from a text file.</li>
<li><a href="http://docs.scipy.org/doc/numpy/reference/generated/numpy.genfromtxt.html">np.genfromtxt</a>: Load data from a text file, with missing values handled as
specified.</li>

</ul>
</section>
<section id="slide-orgheadline10">
<h3 id="orgheadline10">CSV example 2</h3>
<div class="org-src-container">

<pre  class="src src-python"><span style="color: #A52A2A; font-weight: bold;">import</span> numpy <span style="color: #A52A2A; font-weight: bold;">as</span> np

<span style="color: #0084C8; font-weight: bold;">filename</span> = os.path.join<span style="color: #707183;">(</span>f_dir, <span style="color: #4E9A06;">'example2.csv'</span><span style="color: #707183;">)</span>
<span style="color: #0084C8; font-weight: bold;">data</span> =  np.tile<span style="color: #707183;">(</span>np.arange<span style="color: #7388d6;">(</span><span style="color: #F5666D;">0</span>, <span style="color: #F5666D;">5</span><span style="color: #7388d6;">)</span>, <span style="color: #7388d6;">(</span><span style="color: #F5666D;">3</span>, <span style="color: #F5666D;">1</span><span style="color: #7388d6;">)</span><span style="color: #707183;">)</span>.T

<span style="color: #204A87;"># </span><span style="color: #204A87;">save data</span>
np.savetxt<span style="color: #707183;">(</span>filename, data, header=<span style="color: #4E9A06;">'x,y,z'</span>, delimiter=<span style="color: #4E9A06;">','</span><span style="color: #707183;">)</span>

<span style="color: #204A87;"># </span><span style="color: #204A87;">load data</span>
<span style="color: #0084C8; font-weight: bold;">x</span>, <span style="color: #0084C8; font-weight: bold;">y</span>, <span style="color: #0084C8; font-weight: bold;">z</span> = np.loadtxt<span style="color: #707183;">(</span>filename, skiprows=<span style="color: #F5666D;">1</span>, \
    delimiter=<span style="color: #4E9A06;">','</span>, unpack=<span style="color: #F5666D;">True</span><span style="color: #707183;">)</span>
<span style="color: #A52A2A; font-weight: bold;">print</span><span style="color: #707183;">(</span>x, y, z<span style="color: #707183;">)</span>
</pre>
</div>

<pre class="example">
&gt;&gt;&gt; &gt;&gt;&gt; &gt;&gt;&gt; &gt;&gt;&gt; ... &gt;&gt;&gt; &gt;&gt;&gt; ... ... &gt;&gt;&gt; (array([ 0.,  1.,  2.,  3.,  4.]), array([ 0.,  1.,  2.,  3.,  4.]), array([ 0.,  1.,  2.,  3.,  4.]))
</pre>
</section>
<section id="slide-orgheadline11">
<h3 id="orgheadline11">pandas</h3>
<p>
The <a href="http://pandas.pydata.org/pandas-docs/dev/io.html">pandas I/O</a> API is a set of top level reader functions, e.g. for CSV
</p>
<ul>
<li>The Series and DataFrame objects have an instance method <a href="http://pandas.pydata.org/pandas-docs/dev/io.html#io-store-in-csv">to_csv()</a> which allows
storing the contents of the object as a comma-separated-values file.</li>
<li>The two workhorse functions for reading text files are <a href="http://pandas.pydata.org/pandas-docs/dev/io.html#io-read-csv-table">read_csv()</a> and
<a href="http://pandas.pydata.org/pandas-docs/dev/generated/pandas.io.parsers.read_table.html#pandas.io.parsers.read_table">read_table()</a>. They both use the same parsing code to intelligently convert
tabular data into a DataFrame object. See the <a href="http://pandas.pydata.org/pandas-docs/dev/cookbook.html#cookbook-csv">cookbook</a> for some advanced
strategies.</li>

</ul>
</section>
</section>
<section>
<section id="slide-orgheadline17">
<h2 id="orgheadline17">Binary</h2>
<ul>
<li>A binary file is a computer file that is not a text file.</li>
<li>Binary files typically contain bytes that are intended to be interpreted as
something other than text characters.</li>
<li>Some binary files contain headers, blocks of metadata used by a computer
program to interpret the data in the file.</li>
<li>If a binary file is opened in a text editor, each group of eight bits will
typically be translated as a single character,</li>
<li>Binary itself is meaningless, until such time as an executed algorithm defines
what should be done with each bit, byte, word or block.</li>

</ul>
</section>
<section id="slide-orgheadline13">
<h3 id="orgheadline13">Python standard library</h3>
<p>
<a href="https://docs.python.org/2/tutorial/inputoutput.html">Input output routines</a>
</p>
<ul>
<li><code>open()</code>, <code>close()</code></li>
<li><code>read()</code>, <code>readline()</code>, <code>readlines()</code></li>
<li><code>write()</code>, <code>writelines()</code></li>

</ul>
</section>
<section id="slide-orgheadline14">
<h3 id="orgheadline14">Binary example 1</h3>
<div class="org-src-container">

<pre  class="src src-python"><span style="color: #A52A2A; font-weight: bold;">import</span> struct

<span style="color: #0084C8; font-weight: bold;">filename</span> = os.path.join<span style="color: #707183;">(</span>f_dir, <span style="color: #4E9A06;">'example1.bin'</span><span style="color: #707183;">)</span>
<span style="color: #0084C8; font-weight: bold;">points</span> = <span style="color: #707183;">[</span><span style="color: #7388d6;">(</span><span style="color: #F5666D;">1</span>, <span style="color: #F5666D;">2</span><span style="color: #7388d6;">)</span>, <span style="color: #7388d6;">(</span><span style="color: #F5666D;">3</span>, <span style="color: #F5666D;">4</span><span style="color: #7388d6;">)</span>, <span style="color: #7388d6;">(</span><span style="color: #F5666D;">9</span>, <span style="color: #F5666D;">10</span><span style="color: #7388d6;">)</span>, <span style="color: #7388d6;">(</span><span style="color: #F5666D;">23</span>, <span style="color: #F5666D;">14</span><span style="color: #7388d6;">)</span>, <span style="color: #7388d6;">(</span><span style="color: #F5666D;">50</span>, <span style="color: #F5666D;">90</span><span style="color: #7388d6;">)</span><span style="color: #707183;">]</span>

<span style="color: #0084C8; font-weight: bold;">msg</span> = <span style="color: #A020F0;">bytearray</span><span style="color: #707183;">()</span>
msg.extend<span style="color: #707183;">(</span>struct.pack<span style="color: #7388d6;">(</span><span style="color: #4E9A06;">'I'</span>, <span style="color: #A020F0;">len</span><span style="color: #909183;">(</span>points<span style="color: #909183;">)</span><span style="color: #7388d6;">)</span><span style="color: #707183;">)</span>

<span style="color: #A52A2A; font-weight: bold;">for</span> x, y <span style="color: #A52A2A; font-weight: bold;">in</span> points:
    msg.extend<span style="color: #707183;">(</span>struct.pack<span style="color: #7388d6;">(</span><span style="color: #4E9A06;">'II'</span>, x, y<span style="color: #7388d6;">)</span><span style="color: #707183;">)</span>

<span style="color: #204A87;"># </span><span style="color: #204A87;">write data</span>
<span style="color: #A52A2A; font-weight: bold;">with</span> <span style="color: #A020F0;">open</span><span style="color: #707183;">(</span>filename, <span style="color: #4E9A06;">'wb'</span><span style="color: #707183;">)</span> <span style="color: #A52A2A; font-weight: bold;">as</span> f:
    f.write<span style="color: #707183;">(</span>msg<span style="color: #707183;">)</span>

<span style="color: #204A87;"># </span><span style="color: #204A87;">read data</span>
<span style="color: #A52A2A; font-weight: bold;">with</span> <span style="color: #A020F0;">open</span><span style="color: #707183;">(</span>filename, <span style="color: #4E9A06;">'rb'</span><span style="color: #707183;">)</span> <span style="color: #A52A2A; font-weight: bold;">as</span> f:
     <span style="color: #0084C8; font-weight: bold;">n_points</span> = struct.unpack<span style="color: #707183;">(</span><span style="color: #4E9A06;">'I'</span>, f.read<span style="color: #7388d6;">(</span><span style="color: #F5666D;">4</span><span style="color: #7388d6;">)</span><span style="color: #707183;">)[</span><span style="color: #F5666D;">0</span><span style="color: #707183;">]</span>
     <span style="color: #A52A2A; font-weight: bold;">print</span><span style="color: #707183;">(</span>n_points<span style="color: #707183;">)</span>
</pre>
</div>

<pre class="example">
&gt;&gt;&gt; &gt;&gt;&gt; &gt;&gt;&gt; &gt;&gt;&gt; &gt;&gt;&gt; &gt;&gt;&gt; &gt;&gt;&gt; ... ... &gt;&gt;&gt; ... ... ... &gt;&gt;&gt; ... ... ... ... 5
</pre>
</section>
<section id="slide-orgheadline15">
<h3 id="orgheadline15">numpy</h3>
<ul>
<li><a href="http://docs.scipy.org/doc/numpy/reference/generated/numpy.fromfile.html">np.fromfile</a>: Construct an array from data in a text or binary file</li>
<li><a href="http://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.tofile.html#numpy.ndarray.tofile">ndarray.tofile</a>: Write array to a file as text or binary (default)</li>

</ul>
</section>
<section id="slide-orgheadline16">
<h3 id="orgheadline16">Binary example 2</h3>
<div class="org-src-container">

<pre  class="src src-python"><span style="color: #0084C8; font-weight: bold;">filename</span> = os.path.join<span style="color: #707183;">(</span>f_dir, <span style="color: #4E9A06;">'example2.bin'</span><span style="color: #707183;">)</span>

<span style="color: #0084C8; font-weight: bold;">points</span> = np.array<span style="color: #707183;">(</span><span style="color: #7388d6;">[</span><span style="color: #909183;">(</span><span style="color: #F5666D;">1</span>, <span style="color: #F5666D;">2</span><span style="color: #909183;">)</span>, <span style="color: #909183;">(</span><span style="color: #F5666D;">3</span>, <span style="color: #F5666D;">4</span><span style="color: #909183;">)</span>, <span style="color: #909183;">(</span><span style="color: #F5666D;">9</span>, <span style="color: #F5666D;">10</span><span style="color: #909183;">)</span>, <span style="color: #909183;">(</span><span style="color: #F5666D;">23</span>, <span style="color: #F5666D;">14</span><span style="color: #909183;">)</span>, <span style="color: #909183;">(</span><span style="color: #F5666D;">50</span>, <span style="color: #F5666D;">90</span><span style="color: #909183;">)</span><span style="color: #7388d6;">]</span>, 
    dtype=np.int32<span style="color: #707183;">)</span>
points.tofile<span style="color: #707183;">(</span>filename<span style="color: #707183;">)</span>

<span style="color: #0084C8; font-weight: bold;">data</span> = np.fromfile<span style="color: #707183;">(</span>filename, dtype=<span style="color: #7388d6;">[</span><span style="color: #909183;">(</span><span style="color: #4E9A06;">'x'</span>, np.int32<span style="color: #909183;">)</span>, 
    <span style="color: #909183;">(</span><span style="color: #4E9A06;">'y'</span>, np.int32<span style="color: #909183;">)</span><span style="color: #7388d6;">]</span><span style="color: #707183;">)</span>
<span style="color: #A52A2A; font-weight: bold;">print</span><span style="color: #707183;">(</span>data<span style="color: #7388d6;">[</span><span style="color: #4E9A06;">'x'</span><span style="color: #7388d6;">]</span>, data<span style="color: #7388d6;">[</span><span style="color: #4E9A06;">'y'</span><span style="color: #7388d6;">]</span><span style="color: #707183;">)</span>
</pre>
</div>

<pre class="example">
&gt;&gt;&gt; ... &gt;&gt;&gt; &gt;&gt;&gt; &gt;&gt;&gt; ... &gt;&gt;&gt; (array([ 1,  3,  9, 23, 50], dtype=int32), array([ 2,  4, 10, 14, 90], dtype=int32))
</pre>
</section>
</section>
<section>
<section id="slide-orgheadline21">
<h2 id="orgheadline21">Numpy</h2>
<ul>
<li>There are a number of various <a href="http://docs.scipy.org/doc/numpy/reference/routines.io.html">Numpy IO routines</a> (e.g. text, binary and NPZ)</li>
<li><b>NPZ</b>: a standard binary file format for persisting a single arbitrary Numpy
array on disk. The format stores all of the shape and dtype information
necessary to reconstruct the array correctly even on another machine with a
different architecture.</li>

</ul>
</section>
<section id="slide-orgheadline18">
<h3 id="orgheadline18">numpy</h3>
<ul>
<li><a href="http://docs.scipy.org/doc/numpy/reference/generated/numpy.load.html#numpy.load">np.load</a>: load arrays or pickled objects from .npy, .npz or pickled files.</li>
<li><a href="http://docs.scipy.org/doc/numpy/reference/generated/numpy.save.html#numpy.save">np.save</a>: Save an array to a binary file in NumPy .npy format.</li>
<li><a href="http://docs.scipy.org/doc/numpy/reference/generated/numpy.savez.html#numpy.savez">np.savez</a>: Save several arrays into a single file in uncompressed .npz format.</li>
<li><a href="http://docs.scipy.org/doc/numpy/reference/generated/numpy.savez_compressed.html#numpy.savez_compressed">np.savez_compressed</a>: Save several arrays into a single file in compressed .npz
format.</li>

</ul>
</section>
<section id="slide-orgheadline19">
<h3 id="orgheadline19">Numpy example 1</h3>
<div class="org-src-container">

<pre  class="src src-python"><span style="color: #0084C8; font-weight: bold;">filename</span> = os.path.join<span style="color: #707183;">(</span>f_dir, <span style="color: #4E9A06;">'example1.npy'</span><span style="color: #707183;">)</span>
<span style="color: #0084C8; font-weight: bold;">x</span> = np.arange<span style="color: #707183;">(</span><span style="color: #F5666D;">10</span><span style="color: #707183;">)</span>

<span style="color: #204A87;"># </span><span style="color: #204A87;">save data</span>
np.save<span style="color: #707183;">(</span>filename, x<span style="color: #707183;">)</span>

<span style="color: #204A87;"># </span><span style="color: #204A87;">load data</span>
<span style="color: #0084C8; font-weight: bold;">data</span> = np.load<span style="color: #707183;">(</span>filename<span style="color: #707183;">)</span>
<span style="color: #A52A2A; font-weight: bold;">print</span><span style="color: #707183;">(</span>data<span style="color: #707183;">)</span>
</pre>
</div>

<pre class="example">
&gt;&gt;&gt; &gt;&gt;&gt; ... &gt;&gt;&gt; &gt;&gt;&gt; ... &gt;&gt;&gt; [0 1 2 3 4 5 6 7 8 9]
</pre>
</section>
<section id="slide-orgheadline20">
<h3 id="orgheadline20">Numpy example 2</h3>
<div class="org-src-container">

<pre  class="src src-python"><span style="color: #0084C8; font-weight: bold;">filename</span> = os.path.join<span style="color: #707183;">(</span>f_dir, <span style="color: #4E9A06;">'example2.npz'</span><span style="color: #707183;">)</span>
<span style="color: #0084C8; font-weight: bold;">x</span> = np.arange<span style="color: #707183;">(</span><span style="color: #F5666D;">4</span><span style="color: #707183;">)</span>.reshape<span style="color: #707183;">(</span><span style="color: #F5666D;">2</span>, <span style="color: #F5666D;">2</span><span style="color: #707183;">)</span>
<span style="color: #0084C8; font-weight: bold;">y</span> = np.sin<span style="color: #707183;">(</span>x<span style="color: #707183;">)</span>

<span style="color: #204A87;"># </span><span style="color: #204A87;">save data</span>
np.savez<span style="color: #707183;">(</span>filename, x, y=y<span style="color: #707183;">)</span>

<span style="color: #204A87;"># </span><span style="color: #204A87;">load data</span>
<span style="color: #0084C8; font-weight: bold;">data</span> = np.load<span style="color: #707183;">(</span>filename<span style="color: #707183;">)</span>

<span style="color: #A52A2A; font-weight: bold;">print</span><span style="color: #707183;">(</span>data<span style="color: #707183;">)</span>
<span style="color: #A52A2A; font-weight: bold;">print</span><span style="color: #707183;">(</span><span style="color: #4E9A06;">'x:'</span>, data<span style="color: #7388d6;">[</span><span style="color: #4E9A06;">'arr_0'</span><span style="color: #7388d6;">]</span><span style="color: #707183;">)</span>
<span style="color: #A52A2A; font-weight: bold;">print</span><span style="color: #707183;">(</span><span style="color: #4E9A06;">'y:'</span>, data<span style="color: #7388d6;">[</span><span style="color: #4E9A06;">'y'</span><span style="color: #7388d6;">]</span><span style="color: #707183;">)</span>
</pre>
</div>

<pre class="example">
&gt;&gt;&gt; &gt;&gt;&gt; &gt;&gt;&gt; ... &gt;&gt;&gt; &gt;&gt;&gt; ... &gt;&gt;&gt; &gt;&gt;&gt; &lt;numpy.lib.npyio.NpzFile object at 0x7f1c9ac1a890&gt;
('x:', array([[0, 1],
       [2, 3]]))
('y:', array([[ 0.        ,  0.84147098],
       [ 0.90929743,  0.14112001]]))
</pre>
</section>
</section>
<section>
<section id="slide-orgheadline25">
<h2 id="orgheadline25">Matlab</h2>
<ul>
<li>Scipy.io has many <a href="http://docs.scipy.org/doc/scipy/reference/io.html">modules, classes, and functions</a> available to read data from and
write data to a variety of file formats.</li>
<li>Saving and loading Matlab files (.mat)
<ul>
<li>supports: v4 (Level 1.0), v6 and v7 to 7.2 matfiles</li>

</ul></li>

</ul>
</section>
<section id="slide-orgheadline22">
<h3 id="orgheadline22">scipy.io</h3>
<ul>
<li><a href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.io.loadmat.html#scipy.io.loadmat">loadmat</a>: Load MATLAB file</li>
<li><a href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.io.savemat.html">savemat</a>: Save a dictionary of names and arrays into a MATLAB-style .mat file.</li>
<li><a href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.io.whosmat.html">whosmat</a>: List variables inside a MATLAB file</li>

</ul>
</section>
<section id="slide-orgheadline23">
<h3 id="orgheadline23">Matlab example 1</h3>
<div class="org-src-container">

<pre  class="src src-python"><span style="color: #A52A2A; font-weight: bold;">from</span> scipy.io <span style="color: #A52A2A; font-weight: bold;">import</span> loadmat, savemat, whosmat

<span style="color: #0084C8; font-weight: bold;">filename</span> = os.path.join<span style="color: #707183;">(</span>f_dir, <span style="color: #4E9A06;">'example1.mat'</span><span style="color: #707183;">)</span>
<span style="color: #0084C8; font-weight: bold;">x</span> = np.arange<span style="color: #707183;">(</span><span style="color: #F5666D;">10</span><span style="color: #707183;">)</span>

<span style="color: #204A87;"># </span><span style="color: #204A87;">save data</span>
savemat<span style="color: #707183;">(</span>filename, <span style="color: #7388d6;">{</span><span style="color: #4E9A06;">'var1'</span>: x<span style="color: #7388d6;">}</span><span style="color: #707183;">)</span>

<span style="color: #204A87;"># </span><span style="color: #204A87;">load data</span>
<span style="color: #0084C8; font-weight: bold;">data</span> = loadmat<span style="color: #707183;">(</span>filename<span style="color: #707183;">)</span>

<span style="color: #A52A2A; font-weight: bold;">print</span><span style="color: #707183;">(</span>data<span style="color: #7388d6;">[</span><span style="color: #4E9A06;">'var1'</span><span style="color: #7388d6;">]</span><span style="color: #707183;">)</span>
</pre>
</div>

<pre class="example">
&gt;&gt;&gt; &gt;&gt;&gt; &gt;&gt;&gt; &gt;&gt;&gt; ... &gt;&gt;&gt; &gt;&gt;&gt; ... &gt;&gt;&gt; &gt;&gt;&gt; [[0 1 2 3 4 5 6 7 8 9]]
</pre>
</section>
<section id="slide-orgheadline24">
<h3 id="orgheadline24">Matlab example 2</h3>
<div class="org-src-container">

<pre  class="src src-python"><span style="color: #0084C8; font-weight: bold;">filename</span> = os.path.join<span style="color: #707183;">(</span>f_dir, <span style="color: #4E9A06;">'example2.mat'</span><span style="color: #707183;">)</span>
<span style="color: #0084C8; font-weight: bold;">x</span> = np.arange<span style="color: #707183;">(</span><span style="color: #F5666D;">4</span><span style="color: #707183;">)</span>.reshape<span style="color: #707183;">(</span><span style="color: #F5666D;">2</span>, <span style="color: #F5666D;">2</span><span style="color: #707183;">)</span>
<span style="color: #0084C8; font-weight: bold;">y</span> = np.sin<span style="color: #707183;">(</span>x<span style="color: #707183;">)</span>

<span style="color: #204A87;"># </span><span style="color: #204A87;">save data</span>
savemat<span style="color: #707183;">(</span>filename, <span style="color: #7388d6;">{</span><span style="color: #4E9A06;">'var1'</span>: x, <span style="color: #4E9A06;">'y'</span>: y<span style="color: #7388d6;">}</span><span style="color: #707183;">)</span>

<span style="color: #204A87;"># </span><span style="color: #204A87;">show variables</span>
<span style="color: #A52A2A; font-weight: bold;">print</span><span style="color: #707183;">(</span>whosmat<span style="color: #7388d6;">(</span>filename<span style="color: #7388d6;">)</span><span style="color: #707183;">)</span>

<span style="color: #204A87;"># </span><span style="color: #204A87;">load data</span>
<span style="color: #0084C8; font-weight: bold;">data</span> = loadmat<span style="color: #707183;">(</span>filename<span style="color: #707183;">)</span>

<span style="color: #A52A2A; font-weight: bold;">print</span><span style="color: #707183;">(</span>data<span style="color: #7388d6;">[</span><span style="color: #4E9A06;">'y'</span><span style="color: #7388d6;">]</span><span style="color: #707183;">)</span>
</pre>
</div>

<pre class="example">
&gt;&gt;&gt; &gt;&gt;&gt; &gt;&gt;&gt; ... &gt;&gt;&gt; &gt;&gt;&gt; ... [('y', (2, 2), 'double'), ('var1', (2, 2), 'int64')]
&gt;&gt;&gt; ... &gt;&gt;&gt; &gt;&gt;&gt; [[ 0.          0.84147098]
 [ 0.90929743  0.14112001]]
</pre>
</section>
</section>
<section>
<section id="slide-orgheadline26">
<h2 id="orgheadline26">IDL (Exelis VIS)</h2>
<p>
Scipy.io also supports reading IDL (.sav) files
</p>
<ul>
<li><a href="http://docs.scipy.org/doc/scipy/reference/generated/scipy.io.readsav.html#scipy.io.readsav">readsav</a>: Read an IDL .sav file</li>

</ul>

<p>
<a href="http://www.exelisvis.com/docs/overview_of_save_files.html">Overview of SAVE files</a> (from <a href="http://www.exelisvis.com/">Exelisvis</a>): You can create binary files containing
data variables, system variables, functions, procedures, or objects using the
SAVE procedure. These SAVE files can be shared with other users who will be able
to execute the program, but who will not have access to the IDL code that
created it. Variables that are used from session to session can be saved as and
recovered from a SAVE file.
</p>
</section>
</section>
<section>
<section id="slide-orgheadline32">
<h2 id="orgheadline32">NetCDF</h2>
<ul>
<li><a href="http://www.unidata.ucar.edu/software/netcdf/">NetCDF</a> (Network Common Data Form) is a set of software libraries and self-
describing, machine-independent data formats that support the creation,
access, and sharing of array-oriented scientific data.</li>
<li>NetCDF data is:
<ul>
<li><b>Self-Describing</b>: Metadata information about the data are included.</li>
<li><b>Portable</b>: Accessable by computers with different ways of storing integers,
characters, and floating-point numbers.</li>

</ul></li>

</ul>
</section>
<section id="slide-orgheadline27">
<h3 id="orgheadline27">NetCDF</h3>
<ul>
<li>NetCDF data is:
<ul>
<li><b>Scalable</b>: A small subset of a large dataset may be accessed efficiently.</li>
<li><b>Appendable</b>: Data may be appended to a properly structured netCDF file.</li>
<li><b>Sharable</b>: One writer and multiple readers may simultaneously access the same
netCDF file.</li>
<li><b>Archivable</b>: Access to all earlier forms of netCDF data will be supported by
current and future versions of the software.</li>

</ul></li>
<li>Python package: <a href="https://code.google.com/p/netcdf4-python/">netCDF4</a></li>

</ul>
</section>
<section id="slide-orgheadline28">
<h3 id="orgheadline28">netCDF4 example 1 - part 1</h3>
<div class="org-src-container">

<pre  class="src src-python"><span style="color: #A52A2A; font-weight: bold;">import</span> netCDF4

<span style="color: #0084C8; font-weight: bold;">filename</span> = os.path.join<span style="color: #707183;">(</span>f_dir, <span style="color: #4E9A06;">'example1.nc'</span><span style="color: #707183;">)</span>

<span style="color: #0084C8; font-weight: bold;">f</span> = netCDF4.Dataset<span style="color: #707183;">(</span>filename, <span style="color: #4E9A06;">'w'</span>, <span style="color: #A020F0;">format</span>=<span style="color: #4E9A06;">'NETCDF4'</span><span style="color: #707183;">)</span>
<span style="color: #0084C8; font-weight: bold;">grp_temp</span> = f.createGroup<span style="color: #707183;">(</span><span style="color: #4E9A06;">"temperature"</span><span style="color: #707183;">)</span>
<span style="color: #0084C8; font-weight: bold;">subgrp_air</span> = grp_temp.createGroup<span style="color: #707183;">(</span><span style="color: #4E9A06;">"air"</span><span style="color: #707183;">)</span>
<span style="color: #0084C8; font-weight: bold;">subgrp_soil</span> = grp_temp.createGroup<span style="color: #707183;">(</span><span style="color: #4E9A06;">"soil"</span><span style="color: #707183;">)</span>

<span style="color: #A52A2A; font-weight: bold;">print</span><span style="color: #707183;">(</span>grp_temp.groups<span style="color: #707183;">)</span>
</pre>
</div>

<pre class="example">
&gt;&gt;&gt; &gt;&gt;&gt; &gt;&gt;&gt; &gt;&gt;&gt; &gt;&gt;&gt; &gt;&gt;&gt; &gt;&gt;&gt; &gt;&gt;&gt; OrderedDict([('air', &lt;type 'netCDF4._netCDF4.Group'&gt;
group /temperature/air:
    dimensions(sizes): 
    variables(dimensions): 
    groups: 
), ('soil', &lt;type 'netCDF4._netCDF4.Group'&gt;
group /temperature/soil:
    dimensions(sizes): 
    variables(dimensions): 
    groups: 
)])
</pre>
</section>
<section id="slide-orgheadline29">
<h3 id="orgheadline29">netCDF4 example 1 - part 2</h3>
<div class="org-src-container">

<pre  class="src src-python"><span style="color: #204A87;"># </span><span style="color: #204A87;">Create Dimension</span>
<span style="color: #0084C8; font-weight: bold;">lat</span> = f.createDimension<span style="color: #707183;">(</span><span style="color: #4E9A06;">'lat'</span>, <span style="color: #F5666D;">50</span><span style="color: #707183;">)</span>
<span style="color: #0084C8; font-weight: bold;">lon</span> = f.createDimension<span style="color: #707183;">(</span><span style="color: #4E9A06;">'lon'</span>, <span style="color: #F5666D;">50</span><span style="color: #707183;">)</span>
<span style="color: #0084C8; font-weight: bold;">time</span> = f.createDimension<span style="color: #707183;">(</span><span style="color: #4E9A06;">'time'</span>, <span style="color: #F5666D;">None</span><span style="color: #707183;">)</span>

<span style="color: #204A87;"># </span><span style="color: #204A87;">Datasets and Attributes</span>
<span style="color: #0084C8; font-weight: bold;">soil_temp</span> = np.ones<span style="color: #707183;">(</span><span style="color: #7388d6;">(</span><span style="color: #F5666D;">50</span>, <span style="color: #F5666D;">50</span><span style="color: #7388d6;">)</span><span style="color: #707183;">)</span>
<span style="color: #0084C8; font-weight: bold;">soil_dset</span> = subgrp_soil.createVariable<span style="color: #707183;">(</span><span style="color: #4E9A06;">"Soil Temperature"</span>,
    soil_temp.dtype.name, <span style="color: #7388d6;">(</span><span style="color: #4E9A06;">'lat'</span>, <span style="color: #4E9A06;">'lon'</span><span style="color: #7388d6;">)</span><span style="color: #707183;">)</span>
<span style="color: #0084C8; font-weight: bold;">soil_dset</span><span style="color: #707183;">[</span>:<span style="color: #707183;">]</span> = soil_temp

<span style="color: #204A87;"># </span><span style="color: #204A87;">http://docs.python.org/2/library/functions.html#setattr</span>
<span style="color: #204A87;"># </span><span style="color: #204A87;">setattr(x, 'foobar', 123) is equivalent to x.foobar = 123</span>
<span style="color: #A020F0;">setattr</span><span style="color: #707183;">(</span>soil_dset, <span style="color: #4E9A06;">'unit'</span>, <span style="color: #4E9A06;">'degree celsius'</span><span style="color: #707183;">)</span>
<span style="color: #0084C8; font-weight: bold;">soil_dset.scaling</span> = <span style="color: #F5666D;">1</span>
f.close<span style="color: #707183;">()</span>
</pre>
</div>
</section>
<section id="slide-orgheadline30">
<h3 id="orgheadline30">netCDF4 example 1 - part 3</h3>
<div class="org-src-container">

<pre  class="src src-python"><span style="color: #A52A2A; font-weight: bold;">with</span> netCDF4.Dataset<span style="color: #707183;">(</span>filename<span style="color: #707183;">)</span> <span style="color: #A52A2A; font-weight: bold;">as</span> f:
    <span style="color: #A52A2A; font-weight: bold;">print</span><span style="color: #707183;">(</span>f.dimensions<span style="color: #707183;">)</span>
    <span style="color: #A52A2A; font-weight: bold;">print</span><span style="color: #707183;">(</span>f.groups<span style="color: #7388d6;">[</span><span style="color: #4E9A06;">'temperature'</span><span style="color: #7388d6;">]</span>.groups<span style="color: #7388d6;">[</span><span style="color: #4E9A06;">'soil'</span><span style="color: #7388d6;">]</span>.variables<span style="color: #7388d6;">[</span><span style="color: #4E9A06;">'Soil Temperature'</span><span style="color: #7388d6;">]</span><span style="color: #707183;">)</span>
</pre>
</div>

<pre class="example">
... ... OrderedDict([(u'lat', &lt;type 'netCDF4._netCDF4.Dimension'&gt;: name = 'lat', size = 50
), (u'lon', &lt;type 'netCDF4._netCDF4.Dimension'&gt;: name = 'lon', size = 50
), (u'time', &lt;type 'netCDF4._netCDF4.Dimension'&gt; (unlimited): name = 'time', size = 0
)])
&lt;type 'netCDF4._netCDF4.Variable'&gt;
float64 Soil Temperature(lat, lon)
    unit: degree celsius
    scaling: 1
path = /temperature/soil
unlimited dimensions: 
current shape = (50, 50)
filling on, default _FillValue of 9.96920996839e+36 used
</pre>
</section>
<section id="slide-orgheadline31">
<h3 id="orgheadline31">netCDF4 example 1 - part 4</h3>
<div class="org-src-container">

<pre  class="src src-python"><span style="color: #A52A2A; font-weight: bold;">with</span> netCDF4.Dataset<span style="color: #707183;">(</span>filename<span style="color: #707183;">)</span> <span style="color: #A52A2A; font-weight: bold;">as</span> f:
    <span style="color: #A52A2A; font-weight: bold;">print</span><span style="color: #707183;">(</span>f.groups<span style="color: #7388d6;">[</span><span style="color: #4E9A06;">'temperature'</span><span style="color: #7388d6;">]</span>.groups<span style="color: #7388d6;">[</span><span style="color: #4E9A06;">'soil'</span><span style="color: #7388d6;">]</span>.\
        variables<span style="color: #7388d6;">[</span><span style="color: #4E9A06;">'Soil Temperature'</span><span style="color: #7388d6;">][</span>:<span style="color: #7388d6;">]</span><span style="color: #707183;">)</span>
    <span style="color: #A52A2A; font-weight: bold;">print</span><span style="color: #707183;">(</span>f.groups<span style="color: #7388d6;">[</span><span style="color: #4E9A06;">'temperature'</span><span style="color: #7388d6;">]</span>.groups<span style="color: #7388d6;">[</span><span style="color: #4E9A06;">'soil'</span><span style="color: #7388d6;">]</span>.\
        variables<span style="color: #7388d6;">[</span><span style="color: #4E9A06;">'Soil Temperature'</span><span style="color: #7388d6;">]</span>.unit<span style="color: #707183;">)</span>
</pre>
</div>

<pre class="example">
... ... ... ... [[ 1.  1.  1. ...,  1.  1.  1.]
 [ 1.  1.  1. ...,  1.  1.  1.]
 [ 1.  1.  1. ...,  1.  1.  1.]
 ..., 
 [ 1.  1.  1. ...,  1.  1.  1.]
 [ 1.  1.  1. ...,  1.  1.  1.]
 [ 1.  1.  1. ...,  1.  1.  1.]]
degree celsius
</pre>
</section>
</section>
<section>
<section id="slide-orgheadline35">
<h2 id="orgheadline35">HDF5</h2>
<ul>
<li><a href="https://www.hdfgroup.org/HDF5/">HDF5</a> is a data model, library, and file format for storing and managing data.</li>
<li>It supports an unlimited variety of datatypes, and is designed for flexible
and efficient I/O and for high volume and complex data.</li>
<li>HDF5 is portable and is extensible, allowing applications to evolve in their
use of HDF5.</li>
<li>Python package <a href="http://www.h5py.org/">h5py</a></li>

</ul>
</section>
<section id="slide-orgheadline33">
<h3 id="orgheadline33">hdf5 example 1 - part 1</h3>
<div class="org-src-container">

<pre  class="src src-python"><span style="color: #A52A2A; font-weight: bold;">import</span> h5py

<span style="color: #0084C8; font-weight: bold;">filename</span> = os.path.join<span style="color: #707183;">(</span>f_dir, <span style="color: #4E9A06;">'example1.hdf5'</span><span style="color: #707183;">)</span>

<span style="color: #A52A2A; font-weight: bold;">with</span> h5py.File<span style="color: #707183;">(</span>filename, <span style="color: #4E9A06;">'w'</span><span style="color: #707183;">)</span> <span style="color: #A52A2A; font-weight: bold;">as</span> f:
    <span style="color: #0084C8; font-weight: bold;">grp_temp</span> = f.create_group<span style="color: #707183;">(</span><span style="color: #4E9A06;">"temp"</span><span style="color: #707183;">)</span>
    <span style="color: #0084C8; font-weight: bold;">subgrp_soil</span> = grp_temp.create_group<span style="color: #707183;">(</span><span style="color: #4E9A06;">"soil"</span><span style="color: #707183;">)</span>
    <span style="color: #0084C8; font-weight: bold;">soil_temp</span> = np.arange<span style="color: #707183;">(</span><span style="color: #F5666D;">400</span><span style="color: #707183;">)</span>
    <span style="color: #0084C8; font-weight: bold;">soil_dset</span> = subgrp_soil.create_dataset<span style="color: #707183;">(</span><span style="color: #4E9A06;">"Soil Temperature"</span>, \
        data=soil_temp<span style="color: #707183;">)</span>
    <span style="color: #0084C8; font-weight: bold;">soil_dset.attrs</span><span style="color: #707183;">[</span><span style="color: #4E9A06;">'unit'</span><span style="color: #707183;">]</span> = <span style="color: #4E9A06;">'degree celsius'</span>
    <span style="color: #A52A2A; font-weight: bold;">print</span><span style="color: #707183;">(</span>soil_dset<span style="color: #707183;">)</span>
</pre>
</div>
<pre class="example">
&gt;&gt;&gt; &gt;&gt;&gt; &gt;&gt;&gt; ... ... ... ... ... ... ... ... &lt;HDF5 dataset "Soil Temperature": shape (400,), type "&lt;i8"&gt;
</pre>
</section>
<section id="slide-orgheadline34">
<h3 id="orgheadline34">hdf5 example 1 - part 2</h3>
<div class="org-src-container">

<pre  class="src src-python"><span style="color: #0084C8; font-weight: bold;">filename</span> = os.path.join<span style="color: #707183;">(</span>f_dir, <span style="color: #4E9A06;">'example1.hdf5'</span><span style="color: #707183;">)</span>

<span style="color: #A52A2A; font-weight: bold;">with</span> h5py.File<span style="color: #707183;">(</span>filename<span style="color: #707183;">)</span> <span style="color: #A52A2A; font-weight: bold;">as</span> f:
    <span style="color: #A52A2A; font-weight: bold;">print</span><span style="color: #707183;">(</span>f<span style="color: #7388d6;">[</span><span style="color: #4E9A06;">'temp/soil'</span><span style="color: #7388d6;">]</span>.keys<span style="color: #7388d6;">()</span><span style="color: #707183;">)</span>
    <span style="color: #A52A2A; font-weight: bold;">print</span><span style="color: #707183;">(</span>f<span style="color: #7388d6;">[</span><span style="color: #4E9A06;">'temp/soil/Soil Temperature'</span><span style="color: #7388d6;">]</span><span style="color: #707183;">)</span>
    <span style="color: #A52A2A; font-weight: bold;">print</span><span style="color: #707183;">(</span>f<span style="color: #7388d6;">[</span><span style="color: #4E9A06;">'temp/soil/Soil Temperature'</span><span style="color: #7388d6;">][</span><span style="color: #F5666D;">20</span>:<span style="color: #F5666D;">40</span><span style="color: #7388d6;">]</span><span style="color: #707183;">)</span>
</pre>
</div>
<pre class="example">
&gt;&gt;&gt; ... ... ... ... [u'Soil Temperature']
&lt;HDF5 dataset "Soil Temperature": shape (400,), type "&lt;i8"&gt;
[20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39]
</pre>
</section>
</section>
<section>
<section id="slide-orgheadline38">
<h2 id="orgheadline38">Excel</h2>
<ul>
<li><a href="https://openpyxl.readthedocs.org/">Openpyxl</a> is a Python library for reading and writing Excel 2010
xlsx/xlsm/xltx/xltm files.</li>
<li>It was born from lack of existing library to read/write natively from Python
the Office Open XML format.</li>
<li>The package openpyxl is used by <a href="http://pandas.pydata.org/">Pandas</a> to store e.g. DataFrames in Excel
sheets</li>

</ul>
</section>
<section id="slide-orgheadline36">
<h3 id="orgheadline36">Package requirements</h3>
<ul>
<li>pip install <a href="https://pypi.python.org/pypi/openpyxl/">openpyxl</a></li>
<li>pip install <a href="https://pypi.python.org/pypi/xlrd">xlrd</a></li>

</ul>
</section>
<section id="slide-orgheadline37">
<h3 id="orgheadline37">Excel example</h3>
<div class="org-src-container">

<pre  class="src src-python"><span style="color: #A52A2A; font-weight: bold;">import</span> pandas <span style="color: #A52A2A; font-weight: bold;">as</span> pd

<span style="color: #0084C8; font-weight: bold;">filename</span> = os.path.join<span style="color: #707183;">(</span>f_dir, <span style="color: #4E9A06;">'example1.xlsx'</span><span style="color: #707183;">)</span>

<span style="color: #0084C8; font-weight: bold;">df</span> = pd.DataFrame<span style="color: #707183;">(</span><span style="color: #7388d6;">{</span><span style="color: #4E9A06;">'A'</span>: <span style="color: #909183;">[</span><span style="color: #F5666D;">1</span>, <span style="color: #F5666D;">2</span>, <span style="color: #F5666D;">3</span><span style="color: #909183;">]</span>, <span style="color: #4E9A06;">'B'</span>: <span style="color: #909183;">[</span><span style="color: #F5666D;">4</span>, <span style="color: #F5666D;">5</span>, <span style="color: #F5666D;">6</span><span style="color: #909183;">]</span><span style="color: #7388d6;">}</span><span style="color: #707183;">)</span>
df.to_excel<span style="color: #707183;">(</span>filename<span style="color: #707183;">)</span>

<span style="color: #0084C8; font-weight: bold;">data</span> = pd.io.excel.read_excel<span style="color: #707183;">(</span>filename<span style="color: #707183;">)</span>
<span style="color: #A52A2A; font-weight: bold;">print</span><span style="color: #707183;">(</span><span style="color: #A020F0;">type</span><span style="color: #7388d6;">(</span>data<span style="color: #7388d6;">)</span>, data<span style="color: #707183;">)</span>
</pre>
</div>

<pre class="example">
&gt;&gt;&gt; &gt;&gt;&gt; &gt;&gt;&gt; &gt;&gt;&gt; &gt;&gt;&gt; &gt;&gt;&gt; &gt;&gt;&gt; (&lt;class 'pandas.core.frame.DataFrame'&gt;,    A  B
0  1  4
1  2  5
2  3  6)
</pre>
</section>
</section>
<section>
<section id="slide-orgheadline40">
<h2 id="orgheadline40">Pickle</h2>
<ul>
<li>The pickle module implements a fundamental, but powerful algorithm for
serializing and de-serializing a Python object structure.</li>
<li>Pickling is the process whereby a Python object hierarchy is converted into a
byte stream, and unpickling is the inverse operation, whereby a byte stream is
converted back into an object hierarchy.</li>
<li><a href="https://docs.python.org/2/library/pickle.html">This documentation</a> describes both the pickle module and the cPickle module.</li>

</ul>
</section>
<section id="slide-orgheadline39">
<h3 id="orgheadline39">Pickle example 1</h3>
<div class="org-src-container">

<pre  class="src src-python"><span style="color: #A52A2A; font-weight: bold;">import</span> pickle

<span style="color: #0084C8; font-weight: bold;">filename</span> = os.path.join<span style="color: #707183;">(</span>f_dir, <span style="color: #4E9A06;">'example1.pickle'</span><span style="color: #707183;">)</span>

<span style="color: #0084C8; font-weight: bold;">data</span> = <span style="color: #707183;">{</span><span style="color: #4E9A06;">'a'</span>: <span style="color: #7388d6;">[</span><span style="color: #F5666D;">1</span>, <span style="color: #F5666D;">2</span>.<span style="color: #F5666D;">0</span>, <span style="color: #F5666D;">3</span>, <span style="color: #F5666D;">4</span>+<span style="color: #F5666D;">6j</span><span style="color: #7388d6;">]</span>,
        <span style="color: #4E9A06;">'b'</span>: <span style="color: #7388d6;">(</span><span style="color: #4E9A06;">'string'</span>, u<span style="color: #4E9A06;">'Unicode string'</span><span style="color: #7388d6;">)</span>,
        <span style="color: #4E9A06;">'c'</span>: <span style="color: #F5666D;">None</span><span style="color: #707183;">}</span>

<span style="color: #A52A2A; font-weight: bold;">with</span> <span style="color: #A020F0;">open</span><span style="color: #707183;">(</span>filename, <span style="color: #4E9A06;">'wb'</span><span style="color: #707183;">)</span> <span style="color: #A52A2A; font-weight: bold;">as</span> f:
    pickle.dump<span style="color: #707183;">(</span>data, f<span style="color: #707183;">)</span>

<span style="color: #A52A2A; font-weight: bold;">with</span> <span style="color: #A020F0;">open</span><span style="color: #707183;">(</span>filename, <span style="color: #4E9A06;">'rb'</span><span style="color: #707183;">)</span> <span style="color: #A52A2A; font-weight: bold;">as</span> f:
    <span style="color: #A52A2A; font-weight: bold;">print</span><span style="color: #707183;">(</span>pickle.load<span style="color: #7388d6;">(</span>f<span style="color: #7388d6;">)</span><span style="color: #707183;">)</span>
</pre>
</div>

<pre class="example">
&gt;&gt;&gt; &gt;&gt;&gt; &gt;&gt;&gt; ... ... &gt;&gt;&gt; &gt;&gt;&gt; ... ... &gt;&gt;&gt; ... ... {'a': [1, 2.0, 3, (4+6j)], 'c': None, 'b': ('string', u'Unicode string')}
</pre>
</section>
</section>
<section>
<section id="slide-orgheadline44">
<h2 id="orgheadline44">Exercise</h2>
<div class="outline-text-2" id="text-orgheadline44">
</div></section>
<section id="slide-orgheadline41">
<h3 id="orgheadline41">CSV</h3>
<p>
Write a text file using <code>np.savetxt()</code> which contains 3 columns x, y, z:
</p>

<pre class="example">
x = 2, 4, 6, ..., 18 
y = 4, 8, 12, ..., 36 
z = 98, 95, 92, ..., 82
</pre>

<p>
And try to read the file you just wrote using <code>np.loadtxt()</code>
HINT: <code>data = np.vstack((x, y, z)).T</code>
</p>

</section>
<section id="slide-orgheadline42">
<h3 id="orgheadline42">NPZ</h3>
<p>
Use x, y, z again and save them using <code>np.savez()</code> and read them using
<code>np.load()</code>
</p>

</section>
<section id="slide-orgheadline43">
<h3 id="orgheadline43">Binary</h3>
<p>
Write a binary file using <code>ndarray.tofile()</code> with 10 records, where a record looks
like: 
</p>

<pre class="example">
dtype = np.dtype([('id', np.float64),
                  ('height', np.float32),
                  ('weight', np.float32)])
</pre>

<p>
And read it using <code>np.fromfile()</code>
</p>
</section>
</section>
</div>
</div>
<script src="../reveal.js/lib/js/head.min.js"></script>
<script src="../reveal.js/js/reveal.js"></script>

<script>
// Full list of configuration options available here:
// https://github.com/hakimel/reveal.js#configuration
Reveal.initialize({

controls: true,
progress: true,
history: false,
center: true,
slideNumber: 't',
rollingLinks: false,
keyboard: true,
overview: true,

theme: Reveal.getQueryHash().theme, // available themes are in /css/theme
transition: Reveal.getQueryHash().transition || 'default', // default/cube/page/concave/zoom/linear/fade/none
transitionSpeed: 'default',
multiplex: {
    secret: '', // null if client
    id: '', // id, obtained from socket.io server
    url: '' // Location of socket.io server
},

// Optional libraries used to extend on reveal.js
dependencies: [
 { src: '../reveal.js/lib/js/classList.js', condition: function() { return !document.body.classList; } },
 { src: '../reveal.js/plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
 { src: '../reveal.js/plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
 { src: '../reveal.js/plugin/zoom-js/zoom.js', async: true, condition: function() { return !!document.body.classList; } },
 { src: '../reveal.js/plugin/notes/notes.js', async: true, condition: function() { return !!document.body.classList; } }]
});
</script>
</body>
</html>
