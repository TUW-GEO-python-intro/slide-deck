<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<title>Python Packages</title>

<link rel="stylesheet" href="../reveal.js/css/reveal.css"/>
<link rel="stylesheet" href="../reveal.js/css/theme/black.css" id="theme"/>
<link rel="stylesheet" href="../code_formatting.css"/>
<!-- If the query includes 'print-pdf', include the PDF print sheet -->
<script>
    if( window.location.search.match( /print-pdf/gi ) ) {
        var link = document.createElement( 'link' );
        link.rel = 'stylesheet';
        link.type = 'text/css';
        link.href = '../reveal.js/css/print/pdf.css';
        document.getElementsByTagName( 'head' )[0].appendChild( link );
    }
</script>
</head>
<body>
<div class="reveal">
<div class="slides">
<section id="sec-title-slide" data-background="" data-background-size="" data-background-repeat="" data-background-transition="">
<h1>Python Packages</h1> <h2></h2> <h2><a href="mailto:"></a></h2> <h2></h2>
</section>

<section>
<section id="slide-orgheadline3">
<h2 id="orgheadline3">What are packages</h2>
<div class="outline-text-2" id="text-orgheadline3">
</div></section>
<section id="slide-orgheadline1">
<h3 id="orgheadline1">Packages and Modules</h3>
<dl>
<dt>Module</dt><dd>.py file that contains functions/classes or variables</dd>
<dt>Package</dt><dd>Collection of python modules. Can be nested in folders</dd>

</dl>

</section>
<section id="slide-orgheadline2">
<h3 id="orgheadline2">Folders on Filesystem</h3>
<ul>
<li>my_package
<ul>
<li>__init__.py</li>
<li>my_module.py</li>

</ul></li>

</ul>

<p>
<code>__init__.py</code> tells python that the folder contains modules
</p>

<p>
code in <code>__init__.py</code> is executed during import!
</p>

<p>
<a href="http://docs.python.org/2/tutorial/modules.html">http://docs.python.org/2/tutorial/modules.html</a>
</p>

</section>
</section>
<section>
<section id="slide-orgheadline4">
<h2 id="orgheadline4">Using Packages</h2>
<ul>
<li>Packages have to be imported for the program to be able to use them</li>

</ul>
<div class="org-src-container">

<pre  class="src src-python"><span style="color: #00796b;">import</span> math <span style="color: #607d8b;"># </span><span style="color: #607d8b;">import complete module</span>
<span style="color: #00796b;">import</span> very_long_package_name <span style="color: #00796b;">as</span> vlp <span style="color: #607d8b;"># </span><span style="color: #607d8b;">shorten the name </span>
<span style="color: #00796b;">from</span> datetime <span style="color: #00796b;">import</span> date <span style="color: #607d8b;"># </span><span style="color: #607d8b;">import only certain variables/classes/functions</span>
</pre>
</div>
<ul>
<li>Avoid <code class="src src-python"><span style="color: #00796b;">from</span> package <span style="color: #00796b;">import</span> *
</code> -&gt; dirty namespace</li>

</ul>

<p>
Example - Open <code>Anaconda Command Prompt</code> or <code>Shell</code>
</p>

</section>
</section>
<section>
<section id="slide-orgheadline5">
<h2 id="orgheadline5">Where do I look for packages?</h2>
<ul>
<li><a href="http://docs.python.org/2/library/">Standard library</a></li>
<li><a href="https://pypi.python.org/pypi">Python Package Index (PyPI)</a> (67508 packages last week)</li>
<li>Search Engine „python &lt;your problem here&gt;“
<ul>
<li>Project websites</li>
<li>Stackoverflow</li>
<li>Blogs</li>

</ul></li>

</ul>

</section>
</section>
<section>
<section id="slide-orgheadline10">
<h2 id="orgheadline10">Important Standard Library packages</h2>
<div class="outline-text-2" id="text-orgheadline10">
</div></section>
<section id="slide-orgheadline7">
<h3 id="orgheadline7">datetime module</h3>
<p>
Representation of dates and times. <a href="https://docs.python.org/2.7/library/datetime.html">Documentation.</a>
</p>

<div class="org-src-container">

<pre  class="src src-python"><span style="color: #00796b;">from</span> datetime <span style="color: #00796b;">import</span> date
<span style="color: #EF6C00;">a</span> = date<span style="color: #e91e63;">(</span><span style="color: #689f38;">2015</span>, <span style="color: #689f38;">3</span>, <span style="color: #689f38;">1</span><span style="color: #e91e63;">)</span>
<span style="color: #EF6C00;">b</span> = date.today<span style="color: #e91e63;">()</span>
<span style="color: #00796b;">print</span><span style="color: #e91e63;">(</span>a, b<span style="color: #e91e63;">)</span>
<span style="color: #00796b;">print</span><span style="color: #e91e63;">(</span>a.year, a.month, a.day<span style="color: #e91e63;">)</span> <span style="color: #607d8b;"># </span><span style="color: #607d8b;">attribute access</span>
<span style="color: #EF6C00;">delta</span> = b - a <span style="color: #607d8b;"># </span><span style="color: #607d8b;">difference are a datetime.timedelta object</span>
<span style="color: #00796b;">print</span><span style="color: #e91e63;">(</span>delta<span style="color: #e91e63;">)</span>
<span style="color: #00796b;">print</span><span style="color: #e91e63;">(</span><span style="color: #B71C1C;">type</span><span style="color: #1565C0;">(</span>delta<span style="color: #1565C0;">)</span><span style="color: #e91e63;">)</span>
</pre>
</div>

<pre class="example">
2015-03-01 2015-10-19
2015 3 1
232 days, 0:00:00
&lt;class 'datetime.timedelta'&gt;
</pre>

</section>
<section id="slide-orgheadline6">
<h4 id="orgheadline6">datetime</h4>
<div class="org-src-container">

<pre  class="src src-python"><span style="color: #00796b;">from</span> datetime <span style="color: #00796b;">import</span> date, datetime, timedelta, time
<span style="color: #EF6C00;">a</span> = date<span style="color: #e91e63;">(</span><span style="color: #689f38;">2008</span>, <span style="color: #689f38;">5</span>, <span style="color: #689f38;">1</span><span style="color: #e91e63;">)</span>
<span style="color: #EF6C00;">b</span> = time<span style="color: #e91e63;">(</span><span style="color: #689f38;">12</span>, <span style="color: #689f38;">30</span>, <span style="color: #689f38;">15</span><span style="color: #e91e63;">)</span>
<span style="color: #00796b;">print</span><span style="color: #e91e63;">(</span>datetime.combine<span style="color: #1565C0;">(</span>a, b<span style="color: #1565C0;">)</span><span style="color: #e91e63;">)</span>
<span style="color: #00796b;">print</span><span style="color: #e91e63;">(</span>datetime<span style="color: #1565C0;">(</span><span style="color: #689f38;">2008</span>, <span style="color: #689f38;">5</span>, <span style="color: #689f38;">1</span>, <span style="color: #689f38;">12</span>, <span style="color: #689f38;">30</span>, <span style="color: #689f38;">16</span><span style="color: #1565C0;">)</span><span style="color: #e91e63;">)</span>
<span style="color: #607d8b;"># </span><span style="color: #607d8b;">parsing and formatting</span>
<span style="color: #EF6C00;">dt</span> = datetime.strptime<span style="color: #e91e63;">(</span><span style="color: #689f38;">"21/11/06 16:30"</span>, <span style="color: #689f38;">"%d/%m/%y %H:%M"</span><span style="color: #e91e63;">)</span>
<span style="color: #00796b;">print</span><span style="color: #e91e63;">(</span>dt<span style="color: #e91e63;">)</span>
<span style="color: #00796b;">print</span><span style="color: #e91e63;">(</span>dt.strftime<span style="color: #1565C0;">(</span><span style="color: #689f38;">"%A, %d. %B %Y %I:%M%p"</span><span style="color: #1565C0;">)</span><span style="color: #e91e63;">)</span>
</pre>
</div>

<pre class="example">
2008-05-01 12:30:15
2008-05-01 12:30:16
2006-11-21 16:30:00
Tuesday, 21. November 2006 04:30PM
</pre>

<p>
<a href="https://docs.python.org/2.7/library/datetime.html#strftime-and-strptime-behavior">Formatting codes</a>
</p>

<p>
There is also a <a href="https://docs.python.org/2.7/library/calendar.html">calendar</a> module for e.g. leap year checking, getting days in a month.
</p>

</section>
<section id="slide-orgheadline8">
<h3 id="orgheadline8">math module</h3>
<p>
Mathematical functions and constants.
</p>
<div class="org-src-container">

<pre  class="src src-python"><span style="color: #00796b;">import</span> math
<span style="color: #00796b;">print</span><span style="color: #e91e63;">(</span>math.pi, math.e<span style="color: #e91e63;">)</span>
<span style="color: #00796b;">print</span><span style="color: #e91e63;">(</span>math.radians<span style="color: #1565C0;">(</span><span style="color: #689f38;">180</span><span style="color: #1565C0;">)</span>, math.degrees<span style="color: #1565C0;">(</span><span style="color: #689f38;">2</span> * math.pi<span style="color: #1565C0;">)</span><span style="color: #e91e63;">)</span>
<span style="color: #00796b;">print</span><span style="color: #e91e63;">(</span>math.sin<span style="color: #1565C0;">(</span>math.pi / <span style="color: #689f38;">4</span><span style="color: #1565C0;">)</span><span style="color: #e91e63;">)</span>
</pre>
</div>

<pre class="example">
3.141592653589793 2.718281828459045
3.141592653589793 360.0
0.7071067811865475
</pre>

<p>
<a href="https://docs.python.org/2.7/library/math.html">Docs</a>.
</p>

<p>
These is also cmath for complex numbers.
</p>

</section>
<section id="slide-orgheadline9">
<h3 id="orgheadline9">os.path module</h3>
<ul>
<li>path manipulation</li>
<li>Takes care of correct slashes Unix / vs. Windows \</li>

</ul>

<div class="org-src-container">

<pre  class="src src-python"><span style="color: #00796b;">import</span> os
<span style="color: #EF6C00;">p</span> = os.path.join<span style="color: #e91e63;">(</span><span style="color: #689f38;">"test"</span>, <span style="color: #689f38;">"path"</span>, <span style="color: #689f38;">"to"</span>, <span style="color: #689f38;">"file.txt"</span><span style="color: #e91e63;">)</span> <span style="color: #607d8b;"># </span><span style="color: #607d8b;">relative path</span>
<span style="color: #00796b;">print</span><span style="color: #e91e63;">(</span>p<span style="color: #e91e63;">)</span>
<span style="color: #00796b;">print</span><span style="color: #e91e63;">(</span>os.path.abspath<span style="color: #1565C0;">(</span>p<span style="color: #1565C0;">)</span><span style="color: #e91e63;">)</span> <span style="color: #607d8b;"># </span><span style="color: #607d8b;">absolute path</span>
<span style="color: #607d8b;"># </span><span style="color: #607d8b;">split into path and filename with extension</span>
<span style="color: #EF6C00;">path</span>, <span style="color: #EF6C00;">fname_ext</span> = os.path.split<span style="color: #e91e63;">(</span>p<span style="color: #e91e63;">)</span> 
<span style="color: #607d8b;"># </span><span style="color: #607d8b;">split filename and extension</span>
<span style="color: #EF6C00;">fname</span>, <span style="color: #EF6C00;">extension</span> = os.path.splitext<span style="color: #e91e63;">(</span>fname_ext<span style="color: #e91e63;">)</span> 
<span style="color: #00796b;">print</span><span style="color: #e91e63;">(</span>path, fname_ext, fname, extension<span style="color: #e91e63;">)</span>
</pre>
</div>

<pre class="example">
test/path/to/file.txt
/home/cp/workspace/Teaching/120.050 Introduction to Python for Geoscience/slide-deck/03-Python Packages/test/path/to/file.txt
test/path/to file.txt file .txt
</pre>


</section>
</section>
<section>
<section id="slide-orgheadline11">
<h2 id="orgheadline11">Naming imported packages</h2>
<div class="org-src-container">

<pre  class="src src-python"><span style="color: #00796b;">import</span> numpy <span style="color: #00796b;">as</span> np
<span style="color: #00796b;">import</span> matplotlib.pyplot <span style="color: #00796b;">as</span> plt
<span style="color: #00796b;">import</span> pandas <span style="color: #00796b;">as</span> pd
<span style="color: #00796b;">from</span> scipy <span style="color: #00796b;">import</span> optimize
</pre>
</div>

<ul>
<li>Check package documentation for recommendations
<ul>
<li><a href="http://docs.scipy.org/doc/scipy/reference/api.html">e.g. Scipy guidelines</a></li>

</ul></li>
<li>mainly up to you</li>
<li>be consistent</li>

</ul>

</section>
</section>
<section>
<section id="slide-orgheadline18">
<h2 id="orgheadline18">Where does Python look for packages?</h2>
<p>
<a href="http://docs.python.org/2/using/cmdline.html#envvar-PYTHONPATH">Environment variable</a> PYTHONPATH 
</p>
<ul>
<li>Can be set by
<ul>
<li>Manually in command prompt</li>
<li>IDE(e.g. PyScripter)</li>
<li>or python script (<code>sys.path</code> variable)</li>

</ul></li>

</ul>

<p>
Example - Open <code>Anaconda Command Prompt.exe</code> or your <code>Shell</code>
</p>

</section>
<section id="slide-orgheadline12">
<h3 id="orgheadline12">Demo</h3>
<p>
use the provided <code>my_code</code> folder as a basis for this demo.
</p>
<ul>
<li>navigate to the <code>my_code/my_package</code> folder in you shell</li>
<li>start a python interpreter</li>

</ul>
<div class="org-src-container">

<pre  class="src src-python"><span style="color: #00796b;">import</span> hello <span style="color: #607d8b;"># </span><span style="color: #607d8b;">this works because current path is searched</span>
hello.function<span style="color: #e91e63;">()</span>
hello.variable
<span style="color: #558b2f;">exit</span><span style="color: #e91e63;">()</span>
</pre>
</div>

</section>
<section id="slide-orgheadline13">
<h3 id="orgheadline13">the <span class="underline"><span class="underline">init</span></span>.py file</h3>
<ul>
<li>navigate to the <code>my_code</code> folder</li>
<li>start a python interpreter</li>

</ul>
<div class="org-src-container">

<pre  class="src src-python"><span style="color: #00796b;">import</span> my_package.hello <span style="color: #00796b;">as</span> hello <span style="color: #607d8b;"># </span><span style="color: #607d8b;">will give error</span>
<span style="color: #558b2f;">exit</span><span style="color: #e91e63;">()</span>
</pre>
</div>
<ul>
<li>make a <code>__init__.py</code> file in the my_package folder and try again.</li>

</ul>

</section>
<section id="slide-orgheadline14">
<h3 id="orgheadline14">code in <span class="underline"><span class="underline">init</span></span>.py is executed</h3>
<ul>
<li>fill the <code>__init__.py</code> with the following</li>

</ul>
<div class="org-src-container">

<pre  class="src src-python"><span style="color: #00796b;">print</span><span style="color: #e91e63;">(</span><span style="color: #689f38;">"code in __init__.py is executed on import"</span><span style="color: #e91e63;">)</span>
</pre>
</div>
<p>
Then try importing again.
</p>
<div class="org-src-container">

<pre  class="src src-python"><span style="color: #607d8b;"># </span><span style="color: #607d8b;">this should print the text in __init__.py</span>
<span style="color: #00796b;">import</span> my_package.hello <span style="color: #00796b;">as</span> hello
</pre>
</div>

</section>
<section id="slide-orgheadline15">
<h3 id="orgheadline15">working with the PYTHONPATH</h3>
<p>
in the <code>my_code</code> directory run
</p>
<div class="org-src-container">

<pre  class="src src-bash">python call.py <span style="color: #607d8b;"># </span><span style="color: #607d8b;">will throw and ImportError</span>
<span style="color: #B71C1C;">cd</span> my_package
<span style="color: #B71C1C;">set</span> <span style="color: #EF6C00;">PYTHONPATH</span>=%__CD__% <span style="color: #607d8b;"># </span><span style="color: #607d8b;">Windows</span>
<span style="color: #B71C1C;">export</span> <span style="color: #EF6C00;">PYTHONPATH</span>=$<span style="color: #EF6C00;">PWD</span> <span style="color: #607d8b;"># </span><span style="color: #607d8b;">Unix</span>
<span style="color: #B71C1C;">cd</span> ..
python call.py <span style="color: #607d8b;"># </span><span style="color: #607d8b;">works</span>
</pre>
</div>

</section>
<section id="slide-orgheadline16">
<h3 id="orgheadline16">inspecting sys.path</h3>
<p>
Dynamic changes of <code>sys.path</code> are frowned upon
</p>
<div class="org-src-container">

<pre  class="src src-python"><span style="color: #00796b;">import</span> sys
<span style="color: #00796b;">import</span> os
sys.path
<span style="color: #607d8b;"># </span><span style="color: #607d8b;">append current path to searchpath</span>
sys.path.append<span style="color: #e91e63;">(</span>os.path.abspath<span style="color: #1565C0;">(</span><span style="color: #689f38;">"."</span><span style="color: #1565C0;">)</span><span style="color: #e91e63;">)</span>
</pre>
</div>

</section>
<section id="slide-orgheadline17">
<h3 id="orgheadline17">the <span class="underline"><span class="underline">name</span></span> attribute</h3>
<ul>
<li>gives the name of the module</li>
<li>if a .py file is called directly the <code>__name__</code> is <code>__main__</code></li>
<li>see what happens when hello.py is called directly</li>

</ul>

</section>
</section>
<section>
<section id="slide-orgheadline26">
<h2 id="orgheadline26">How to install a python package</h2>
<dl>
<dt>Pure Python Packages</dt><dd>Source code is only python. Easy to install on every platform.</dd>
<dt>Packages with compiled extensions</dt><dd>These packages often include C or
Fortran code that must be compiled for your platform.
<ul>
<li>Compiler is needed (not easy on Windows)</li>
<li>Check Anaconda (<code>conda</code>) first</li>

</ul></dd>

</dl>

</section>
<section id="slide-orgheadline19">
<h3 id="orgheadline19">Package formats</h3>
<ul>
<li>zipped (.zip, .tar.gz)</li>
<li>compiled (.exe, .whl)</li>
<li>Wheel (.whl) is the new standard packaging format
<ul>
<li>zip file containing all the files needed by a package</li>
<li>Also for compiled extensions</li>
<li>Example of <a href="https://www.python.org/dev/peps/pep-0427/#file-format">wheel file format</a>
<ul>
<li><code>numpy‑1.9.2+mkl‑cp34‑none‑win32.whl</code></li>

</ul></li>

</ul></li>

</ul>
</section>
<section id="slide-orgheadline20">
<h3 id="orgheadline20">pip</h3>
<ul>
<li>the standard tool for installing packages.</li>
<li>automatically searches PyPI</li>
<li>downloads and installs dependencies.</li>

</ul>

<div class="org-src-container">

<pre  class="src src-bash">pip list <span style="color: #607d8b;"># </span><span style="color: #607d8b;">list installed packages</span>
pip install packagename <span style="color: #607d8b;"># </span><span style="color: #607d8b;">install</span>
pip install <span style="color: #EF6C00;">packagename</span>==<span style="color: #689f38;">1.4</span> <span style="color: #607d8b;"># </span><span style="color: #607d8b;">specific version</span>
pip install package1 package2 <span style="color: #607d8b;"># </span><span style="color: #607d8b;">multiply packages</span>
pip install packagename -U <span style="color: #607d8b;"># </span><span style="color: #607d8b;">upgrade the package to newest version</span>
pip uninstall packagename <span style="color: #607d8b;"># </span><span style="color: #607d8b;">uninstall</span>
</pre>
</div>

</section>
<section id="slide-orgheadline21">
<h3 id="orgheadline21">conda</h3>
<ul>
<li>Comes with the Anaconda Python Distribution</li>
<li>Installs packages supported by Anaconda</li>
<li>Also available on pip but precompiled</li>
<li>Chart <a href="http://conda.pydata.org/docs/_downloads/conda-pip-virtualenv-translator.html">conda vs. pip vs. virtualenv</a></li>

</ul>

</section>
<section id="slide-orgheadline22">
<h3 id="orgheadline22">Virtual Environments</h3>
<ul>
<li>Isolates packages into standalone environment.</li>
<li>If applications need different, incompatible versions of libraries.</li>
<li>If you do not have rights to install packages on system (e.g. VSC)</li>
<li>Python 2.7 -&gt; <code>virtualenv</code></li>
<li>Python 3.3, 3.4 -&gt; <code>pyvenv</code> included in python</li>
<li><code>conda create</code></li>

</ul>

</section>
<section id="slide-orgheadline25">
<h3 id="orgheadline25">Let's try it</h3>
<div class="outline-text-3" id="text-orgheadline25">
</div></section>
<section id="slide-orgheadline23">
<h4 id="orgheadline23"></h4>
<div class="org-src-container">

<pre  class="src src-bash">conda create -n test_ve pip numpy
<span style="color: #B71C1C;">source</span> activate test_ve
pip install pygeobase
pip list
conda list
pip uninstall pygeobase
pip list
<span style="color: #B71C1C;">source</span> deactivate
</pre>
</div>

</section>
<section id="slide-orgheadline24">
<h4 id="orgheadline24"></h4>
<div class="org-src-container">

<pre  class="src src-bash"><span style="color: #607d8b;"># </span><span style="color: #607d8b;">Dowload package from PyPI as tar.gz</span>
pip install **.tar.gz
tar -xf 
<span style="color: #B71C1C;">cd</span>
python setup.py install
pip list
</pre>
</div>
</section>
</section>
<section>
<section id="slide-orgheadline27">
<h2 id="orgheadline27">Creating your own package</h2>
<p>
If you want to distribute your own package it is not too difficult.
</p>
<ul>
<li>Watch <a href="https://www.youtube.com/watch?v=GeYis4ZuluY&amp;list=PLybPZmQbie2C_QdUiXOESx7bD67JHmTdf">this video</a></li>
<li>Use <a href="http://pyscaffold.readthedocs.org/en/v2.0.2/">Pyscaffold</a> for project setup</li>
<li>Use Github for code hosting</li>

</ul>

</section>
</section>
<section>
<section id="slide-orgheadline28">
<h2 id="orgheadline28">Additional Information</h2>
<ul>
<li><a href="https://packaging.python.org/">Python Packaging User Guide</a></li>
<li><a href="https://www.youtube.com/watch?v=jOiAp3wtx18">This Talk from PyCon 2014</a></li>
<li><a href="https://packaging.python.org/en/latest/projects.html#conda">Conda package manager</a> good for scientific packages</li>
<li>Python Distributions come with a lot of packages pre-installed
<ul>
<li><a href="https://store.continuum.io/cshop/anaconda/">Anaconda</a> includes conda package manager</li>
<li><a href="https://winpython.github.io/">WinPython</a></li>

</ul></li>

</ul>
</section>
</section>
</div>
</div>

<script src="../reveal.js/lib/js/head.min.js"></script>
<script src="../reveal.js/js/reveal.js"></script>

<script>
// Full list of configuration options available here:
// https://github.com/hakimel/reveal.js#configuration
Reveal.initialize({

controls: true,
progress: true,
history: false,
center: true,
slideNumber: true,
rollingLinks: false,
keyboard: true,
overview: true,

theme: Reveal.getQueryHash().theme, // available themes are in /css/theme
transition: Reveal.getQueryHash().transition || 'default', // default/cube/page/concave/zoom/linear/fade/none
transitionSpeed: 'default',
multiplex: {
    secret: '', // null if client
    id: '', // id, obtained from socket.io server
    url: '' // Location of socket.io server
},

// Optional libraries used to extend on reveal.js
dependencies: [

]
});
</script>
</body>
</html>
