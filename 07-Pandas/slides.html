<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<title>Pandas</title>

<link rel="stylesheet" href="../reveal.js/css/reveal.css"/>
<link rel="stylesheet" href="../reveal.js/css/theme/black.css" id="theme"/>
<link rel="stylesheet" href="../code_formatting.css"/>
<!-- If the query includes 'print-pdf', include the PDF print sheet -->
<script>
    if( window.location.search.match( /print-pdf/gi ) ) {
        var link = document.createElement( 'link' );
        link.rel = 'stylesheet';
        link.type = 'text/css';
        link.href = '../reveal.js/css/print/pdf.css';
        document.getElementsByTagName( 'head' )[0].appendChild( link );
    }
</script>
</head>
<body>
<div class="reveal">
<div class="slides">
<section id="sec-title-slide" data-background="" data-background-size="" data-background-repeat="" data-background-transition="">
<h1>Pandas</h1> <h2></h2> <h2><a href="mailto:"></a></h2> <h2></h2>
</section>

<section>
<section id="slide-orgheadline1">
<h2 id="orgheadline1">A Python Data Analysis Library</h2>
<ul>
<li>Built on top of numpy to make data analysis easier</li>
<li>Automatic data alignment based on labels or indices</li>
<li>Data aggregation, transformation and grouping</li>
<li>Intuitive merging and joining of datasets</li>
<li>Hierarchical labeling</li>
<li>Reading and Writing of CSV, Excel and others</li>

</ul>

</section>
</section>
<section>
<section id="slide-orgheadline6">
<h2 id="orgheadline6">Pandas.Series</h2>
<ul>
<li>For storing indexed 1D data</li>

</ul>
<p>
creation from numpy array with list as index
</p>
<div class="org-src-container">

<pre  class="src src-python"><span style="color: #EF6C00;">s</span> = pd.Series<span style="color: #e91e63;">(</span>np.arange<span style="color: #1565C0;">(</span><span style="color: #689f38;">5</span><span style="color: #1565C0;">)</span>, index=<span style="color: #1565C0;">[</span><span style="color: #689f38;">'a'</span>, <span style="color: #689f38;">'b'</span>, <span style="color: #689f38;">'c'</span>, <span style="color: #689f38;">'d'</span>, <span style="color: #689f38;">'e'</span><span style="color: #1565C0;">]</span><span style="color: #e91e63;">)</span>
<span style="color: #00796b;">print</span><span style="color: #e91e63;">(</span>s<span style="color: #e91e63;">)</span>
</pre>
</div>

<pre class="example">
a    0
b    1
c    2
d    3
e    4
dtype: int64
</pre>
</section>
<section id="slide-orgheadline2">
<h3 id="orgheadline2">Index is created if not set</h3>
<div class="org-src-container">

<pre  class="src src-python">pd.Series<span style="color: #e91e63;">(</span>randn<span style="color: #1565C0;">(</span><span style="color: #689f38;">5</span><span style="color: #1565C0;">)</span><span style="color: #e91e63;">)</span>
</pre>
</div>

<pre class="example">
0   -1.435335
1   -2.523561
2   -1.356375
3    0.016566
4   -0.297398
dtype: float64
</pre>
</section>
<section id="slide-orgheadline3">
<h3 id="orgheadline3">Series is like an array</h3>
<div class="org-src-container">

<pre  class="src src-python">s<span style="color: #e91e63;">[</span><span style="color: #689f38;">0</span><span style="color: #e91e63;">]</span>
<span style="color: #00796b;">print</span><span style="color: #e91e63;">(</span><span style="color: #689f38;">"\n"</span><span style="color: #e91e63;">)</span>
s<span style="color: #e91e63;">[</span>s &gt; s.median<span style="color: #1565C0;">()</span><span style="color: #e91e63;">]</span>
<span style="color: #00796b;">print</span><span style="color: #e91e63;">(</span><span style="color: #689f38;">"\n"</span><span style="color: #e91e63;">)</span>
s<span style="color: #e91e63;">[</span><span style="color: #1565C0;">[</span><span style="color: #689f38;">3</span>,<span style="color: #689f38;">2</span>,<span style="color: #689f38;">1</span><span style="color: #1565C0;">]</span><span style="color: #e91e63;">]</span>
</pre>
</div>

<pre class="example">
0

d    3
e    4
dtype: int64

d    3
c    2
b    1
dtype: int64
</pre>
</section>
<section id="slide-orgheadline4">
<h3 id="orgheadline4">Series is like a dictionary</h3>
<div class="org-src-container">

<pre  class="src src-python">s<span style="color: #e91e63;">[</span><span style="color: #689f38;">'a'</span><span style="color: #e91e63;">]</span>
<span style="color: #EF6C00;">s</span><span style="color: #e91e63;">[</span><span style="color: #689f38;">'e'</span><span style="color: #e91e63;">]</span> = <span style="color: #689f38;">6</span>
s
<span style="color: #689f38;">'e'</span> <span style="color: #00796b;">in</span> s
<span style="color: #689f38;">'f'</span> <span style="color: #00796b;">in</span> s
</pre>
</div>

<pre class="example">
0
&gt;&gt;&gt; a    0
b    1
c    2
d    3
e    6
dtype: int64
True
False
</pre>
</section>
<section id="slide-orgheadline5">
<h3 id="orgheadline5">Operations on Series</h3>
<div class="org-src-container">

<pre  class="src src-python">s+s
s**<span style="color: #689f38;">2</span>
np.exp<span style="color: #e91e63;">(</span>s<span style="color: #e91e63;">)</span>
</pre>
</div>

<pre class="example">
a     0
b     2
c     4
d     6
e    12
dtype: int64
a     0
b     1
c     4
d     9
e    36
dtype: int64
a      1.000000
b      2.718282
c      7.389056
d     20.085537
e    403.428793
dtype: float64
</pre>

</section>
</section>
<section>
<section id="slide-orgheadline35">
<h2 id="orgheadline35">Pandas.DataFrame</h2>
<p>
A 2D labeled data structure with columns of potentially
different types. 
</p>

<p>
Like Series, DataFrame accepts many different kinds of input:
</p>

<ul>
<li>Dict of 1D ndarrays, lists, dicts, or Series</li>
<li>2-D numpy.ndarray</li>
<li>Structured or record ndarray</li>
<li>A Series</li>
<li>Another DataFrame</li>

</ul>

</section>
<section id="slide-orgheadline7">
<h3 id="orgheadline7">From dictionary</h3>
<div class="org-src-container">

<pre  class="src src-python"><span style="color: #EF6C00;">d</span> = <span style="color: #e91e63;">{</span><span style="color: #689f38;">'one'</span> : pd.Series<span style="color: #1565C0;">(</span><span style="color: #EF6C00;">[</span><span style="color: #689f38;">1</span>., <span style="color: #689f38;">2</span>., <span style="color: #689f38;">3</span>.<span style="color: #EF6C00;">]</span>, index=<span style="color: #EF6C00;">[</span><span style="color: #689f38;">'a'</span>, <span style="color: #689f38;">'b'</span>, <span style="color: #689f38;">'c'</span><span style="color: #EF6C00;">]</span><span style="color: #1565C0;">)</span>,
     <span style="color: #689f38;">'two'</span> : pd.Series<span style="color: #1565C0;">(</span><span style="color: #EF6C00;">[</span><span style="color: #689f38;">1</span>., <span style="color: #689f38;">2</span>., <span style="color: #689f38;">3</span>., <span style="color: #689f38;">4</span>.<span style="color: #EF6C00;">]</span>, index=<span style="color: #EF6C00;">[</span><span style="color: #689f38;">'a'</span>, <span style="color: #689f38;">'b'</span>, <span style="color: #689f38;">'c'</span>, <span style="color: #689f38;">'d'</span><span style="color: #EF6C00;">]</span><span style="color: #1565C0;">)</span><span style="color: #e91e63;">}</span>
<span style="color: #EF6C00;">df</span> = pd.DataFrame<span style="color: #e91e63;">(</span>d<span style="color: #e91e63;">)</span>
</pre>
</div>

<div class="org-src-container">

<pre  class="src src-python">df
</pre>
</div>

<pre class="example">
   one  two
a    1    1
b    2    2
c    3    3
d  NaN    4
</pre>

</section>
<section id="slide-orgheadline8">
<h3 id="orgheadline8">From other DataFrame</h3>
<div class="org-src-container">

<pre  class="src src-python">pd.DataFrame<span style="color: #e91e63;">(</span>df, index=<span style="color: #1565C0;">[</span><span style="color: #689f38;">'d'</span>, <span style="color: #689f38;">'b'</span>, <span style="color: #689f38;">'a'</span><span style="color: #1565C0;">]</span><span style="color: #e91e63;">)</span>
</pre>
</div>

<pre class="example">
   one  two
d  NaN    4
b    2    2
a    1    1
</pre>

<div class="org-src-container">

<pre  class="src src-python">pd.DataFrame<span style="color: #e91e63;">(</span>d, index=<span style="color: #1565C0;">[</span><span style="color: #689f38;">'d'</span>, <span style="color: #689f38;">'b'</span>, <span style="color: #689f38;">'a'</span><span style="color: #1565C0;">]</span>, columns=<span style="color: #1565C0;">[</span><span style="color: #689f38;">'two'</span>, <span style="color: #689f38;">'three'</span><span style="color: #1565C0;">]</span><span style="color: #e91e63;">)</span>
</pre>
</div>

<pre class="example">
   two three
d    4   NaN
b    2   NaN
a    1   NaN
</pre>

</section>
<section id="slide-orgheadline10">
<h3 id="orgheadline10">Complex cases</h3>
<div class="org-src-container">

<pre  class="src src-python"><span style="color: #EF6C00;">df2</span> = pd.DataFrame<span style="color: #e91e63;">(</span><span style="color: #1565C0;">{</span><span style="color: #689f38;">'A'</span>: <span style="color: #689f38;">1</span>.,
                    <span style="color: #689f38;">'B'</span>: pd.Timestamp<span style="color: #EF6C00;">(</span><span style="color: #689f38;">'20130102'</span><span style="color: #EF6C00;">)</span>,
                    <span style="color: #689f38;">'C'</span>: pd.Series<span style="color: #EF6C00;">(</span><span style="color: #689f38;">1</span>,index=<span style="color: #B71C1C;">list</span><span style="color: #B388FF;">(</span><span style="color: #B71C1C;">range</span><span style="color: #76ff03;">(</span><span style="color: #689f38;">4</span><span style="color: #76ff03;">)</span><span style="color: #B388FF;">)</span>,
                                   dtype=<span style="color: #689f38;">'float32'</span><span style="color: #EF6C00;">)</span>,
                    <span style="color: #689f38;">'D'</span>: np.array<span style="color: #EF6C00;">(</span><span style="color: #B388FF;">[</span><span style="color: #689f38;">3</span><span style="color: #B388FF;">]</span> * <span style="color: #689f38;">4</span>,dtype=<span style="color: #689f38;">'int32'</span><span style="color: #EF6C00;">)</span>,
                    <span style="color: #689f38;">'E'</span>: <span style="color: #689f38;">'foo'</span> <span style="color: #1565C0;">}</span><span style="color: #e91e63;">)</span>
</pre>
</div>

<div class="org-src-container">

<pre  class="src src-python">df2
</pre>
</div>

<pre class="example">
   A          B  C  D    E
0  1 2013-01-02  1  3  foo
1  1 2013-01-02  1  3  foo
2  1 2013-01-02  1  3  foo
3  1 2013-01-02  1  3  foo
</pre>

</section>
<section id="slide-orgheadline9">
<h4 id="orgheadline9"></h4>
<div class="org-src-container">

<pre  class="src src-python"><span style="color: #EF6C00;">df2</span> = pd.DataFrame<span style="color: #e91e63;">(</span><span style="color: #1565C0;">{</span><span style="color: #689f38;">'A'</span>: <span style="color: #689f38;">1</span>.,
                    <span style="color: #689f38;">'B'</span>: pd.Timestamp<span style="color: #EF6C00;">(</span><span style="color: #689f38;">'20130102'</span><span style="color: #EF6C00;">)</span>,
                    <span style="color: #689f38;">'C'</span>: pd.Series<span style="color: #EF6C00;">(</span><span style="color: #689f38;">1</span>,index=<span style="color: #B71C1C;">list</span><span style="color: #B388FF;">(</span><span style="color: #B71C1C;">range</span><span style="color: #76ff03;">(</span><span style="color: #689f38;">4</span><span style="color: #76ff03;">)</span><span style="color: #B388FF;">)</span>,
                                   dtype=<span style="color: #689f38;">'float32'</span><span style="color: #EF6C00;">)</span>,
                    <span style="color: #689f38;">'D'</span>: np.array<span style="color: #EF6C00;">(</span><span style="color: #B388FF;">[</span><span style="color: #689f38;">3</span><span style="color: #B388FF;">]</span> * <span style="color: #689f38;">4</span>,dtype=<span style="color: #689f38;">'int32'</span><span style="color: #EF6C00;">)</span>,
                    <span style="color: #689f38;">'E'</span>: <span style="color: #689f38;">'foo'</span> <span style="color: #1565C0;">}</span><span style="color: #e91e63;">)</span>
</pre>
</div>

<div class="org-src-container">

<pre  class="src src-python">df2.dtypes
</pre>
</div>

<pre class="example">
A           float64
B    datetime64[ns]
C           float32
D             int32
E            object
dtype: object
</pre>

</section>
<section id="slide-orgheadline11">
<h3 id="orgheadline11">Time series</h3>
<div class="org-src-container">

<pre  class="src src-python"><span style="color: #607d8b;"># </span><span style="color: #607d8b;">Date range</span>
<span style="color: #EF6C00;">dates</span> = pd.date_range<span style="color: #e91e63;">(</span><span style="color: #689f38;">'20130101'</span>, periods=<span style="color: #689f38;">6</span><span style="color: #e91e63;">)</span>
<span style="color: #607d8b;"># </span><span style="color: #607d8b;">Dataframes</span>
<span style="color: #EF6C00;">df</span> = pd.DataFrame<span style="color: #e91e63;">(</span>np.random.randn<span style="color: #1565C0;">(</span><span style="color: #689f38;">6</span>, <span style="color: #689f38;">4</span><span style="color: #1565C0;">)</span>, index=dates, columns=<span style="color: #B71C1C;">list</span><span style="color: #1565C0;">(</span><span style="color: #689f38;">'ABCD'</span><span style="color: #1565C0;">)</span><span style="color: #e91e63;">)</span>
</pre>
</div>
<div class="org-src-container">

<pre  class="src src-python">df
</pre>
</div>

<pre class="example">
                   A         B         C         D
2013-01-01 -0.206765  0.350524 -1.617857 -0.736760
2013-01-02 -0.519446  1.185063  1.176936  0.385541
2013-01-03 -0.612372  0.164813 -0.433153  0.154663
2013-01-04  0.493483  0.294654  1.509413  1.070845
2013-01-05  0.853607 -0.638706 -1.781561  2.053478
2013-01-06 -0.268534 -0.759996 -1.456812  0.028835
</pre>

</section>
<section id="slide-orgheadline12">
<h3 id="orgheadline12">Inspection</h3>
<div class="org-src-container">

<pre  class="src src-python">df.head<span style="color: #e91e63;">()</span>
</pre>
</div>

<pre class="example">
                   A         B         C         D
2013-01-01 -0.206765  0.350524 -1.617857 -0.736760
2013-01-02 -0.519446  1.185063  1.176936  0.385541
2013-01-03 -0.612372  0.164813 -0.433153  0.154663
2013-01-04  0.493483  0.294654  1.509413  1.070845
2013-01-05  0.853607 -0.638706 -1.781561  2.053478
</pre>
<div class="org-src-container">

<pre  class="src src-python">df.tail<span style="color: #e91e63;">(</span><span style="color: #689f38;">3</span><span style="color: #e91e63;">)</span>
</pre>
</div>

<pre class="example">
                   A         B         C         D
2013-01-04  0.493483  0.294654  1.509413  1.070845
2013-01-05  0.853607 -0.638706 -1.781561  2.053478
2013-01-06 -0.268534 -0.759996 -1.456812  0.028835
</pre>
</section>
<section id="slide-orgheadline13">
<h3 id="orgheadline13">Columns and values</h3>
<div class="org-src-container">

<pre  class="src src-python">df.columns, df.values
</pre>
</div>

<pre class="example">
(Index(['A', 'B', 'C', 'D'], dtype='object'),
 array([[-0.20676519,  0.35052391, -1.61785684, -0.73675974],
       [-0.51944644,  1.18506269,  1.17693572,  0.38554099],
       [-0.61237228,  0.16481312, -0.43315343,  0.15466335],
       [ 0.49348278,  0.29465366,  1.50941344,  1.07084483],
       [ 0.85360735, -0.63870612, -1.78156098,  2.05347844],
       [-0.26853374, -0.75999558, -1.45681235,  0.02883511]]))
</pre>
</section>
<section id="slide-orgheadline14">
<h3 id="orgheadline14">Describe a DataFrame</h3>
<div class="org-src-container">

<pre  class="src src-python">df.describe<span style="color: #e91e63;">()</span>
</pre>
</div>

<pre class="example">
              A         B         C         D
count  6.000000  6.000000  6.000000  6.000000
mean  -0.043338  0.099392 -0.433839  0.492767
std    0.586615  0.716588  1.458462  0.961538
min   -0.612372 -0.759996 -1.781561 -0.736760
25%   -0.456718 -0.437826 -1.577596  0.060292
50%   -0.237649  0.229733 -0.944983  0.270102
75%    0.318421  0.336556  0.774413  0.899519
max    0.853607  1.185063  1.509413  2.053478
</pre>
</section>
<section id="slide-orgheadline15">
<h3 id="orgheadline15">DataFrame Slicing Overview</h3>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">Operation</th>
<th scope="col" class="org-left">Syntax</th>
<th scope="col" class="org-left">Result</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">Select column</td>
<td class="org-left"><code>df[col]</code></td>
<td class="org-left">Series</td>
</tr>

<tr>
<td class="org-left">Select row by label</td>
<td class="org-left"><code>df.loc[label]</code></td>
<td class="org-left">Series</td>
</tr>

<tr>
<td class="org-left">Select row by integer location</td>
<td class="org-left"><code>df.iloc[loc]</code></td>
<td class="org-left">Series</td>
</tr>

<tr>
<td class="org-left">Slice rows</td>
<td class="org-left"><code>df[5:10]</code></td>
<td class="org-left">DataFrame</td>
</tr>

<tr>
<td class="org-left">Select rows by boolean vector</td>
<td class="org-left"><code>df[bool_vec]</code></td>
<td class="org-left">DataFrame</td>
</tr>
</tbody>
</table>
</section>
<section id="slide-orgheadline16">
<h3 id="orgheadline16">By column or row slice</h3>
<div class="org-src-container">

<pre  class="src src-python">df<span style="color: #e91e63;">[</span><span style="color: #689f38;">'A'</span><span style="color: #e91e63;">]</span>
</pre>
</div>

<pre class="example">
2013-01-01   -0.206765
2013-01-02   -0.519446
2013-01-03   -0.612372
2013-01-04    0.493483
2013-01-05    0.853607
2013-01-06   -0.268534
Freq: D, Name: A, dtype: float64
</pre>

<div class="org-src-container">

<pre  class="src src-python">df<span style="color: #e91e63;">[</span><span style="color: #689f38;">0</span>:<span style="color: #689f38;">3</span><span style="color: #e91e63;">]</span>
</pre>
</div>

<pre class="example">
                   A         B         C         D
2013-01-01 -0.206765  0.350524 -1.617857 -0.736760
2013-01-02 -0.519446  1.185063  1.176936  0.385541
2013-01-03 -0.612372  0.164813 -0.433153  0.154663
</pre>
</section>
<section id="slide-orgheadline17">
<h3 id="orgheadline17">by index</h3>
<div class="org-src-container">

<pre  class="src src-python">df<span style="color: #e91e63;">[</span><span style="color: #689f38;">'20130102'</span>:<span style="color: #689f38;">'20130104'</span><span style="color: #e91e63;">]</span>
</pre>
</div>

<pre class="example">
                   A         B         C         D
2013-01-02 -0.519446  1.185063  1.176936  0.385541
2013-01-03 -0.612372  0.164813 -0.433153  0.154663
2013-01-04  0.493483  0.294654  1.509413  1.070845
</pre>
<div class="org-src-container">

<pre  class="src src-python"><span style="color: #00796b;">from</span> datetime <span style="color: #00796b;">import</span> date
df<span style="color: #e91e63;">[</span>date<span style="color: #1565C0;">(</span><span style="color: #689f38;">2013</span>,<span style="color: #689f38;">1</span>,<span style="color: #689f38;">2</span><span style="color: #1565C0;">)</span>:date<span style="color: #1565C0;">(</span><span style="color: #689f38;">2013</span>,<span style="color: #689f38;">1</span>,<span style="color: #689f38;">4</span><span style="color: #1565C0;">)</span><span style="color: #e91e63;">]</span>
</pre>
</div>

<pre class="example">
                   A         B         C         D
2013-01-02 -0.519446  1.185063  1.176936  0.385541
2013-01-03 -0.612372  0.164813 -0.433153  0.154663
2013-01-04  0.493483  0.294654  1.509413  1.070845
</pre>

</section>
<section id="slide-orgheadline18">
<h3 id="orgheadline18">by integer location</h3>
<div class="org-src-container">

<pre  class="src src-python">df.iloc<span style="color: #e91e63;">[</span><span style="color: #1565C0;">[</span><span style="color: #689f38;">4</span>, <span style="color: #689f38;">2</span><span style="color: #1565C0;">]</span><span style="color: #e91e63;">]</span>
</pre>
</div>

<pre class="example">
                   A         B         C         D
2013-01-05  0.853607 -0.638706 -1.781561  2.053478
2013-01-03 -0.612372  0.164813 -0.433153  0.154663
</pre>

</section>
<section id="slide-orgheadline19">
<h3 id="orgheadline19">Grouping</h3>
<div class="org-src-container">

<pre  class="src src-python"><span style="color: #EF6C00;">gp</span> = pd.DataFrame<span style="color: #e91e63;">(</span><span style="color: #1565C0;">{</span><span style="color: #689f38;">'A'</span> : <span style="color: #EF6C00;">[</span><span style="color: #689f38;">'foo'</span>, <span style="color: #689f38;">'bar'</span>, <span style="color: #689f38;">'foo'</span>, <span style="color: #689f38;">'bar'</span>,
                          <span style="color: #689f38;">'foo'</span>, <span style="color: #689f38;">'bar'</span>, <span style="color: #689f38;">'foo'</span>, <span style="color: #689f38;">'foo'</span><span style="color: #EF6C00;">]</span>,
                   <span style="color: #689f38;">'B'</span> : <span style="color: #EF6C00;">[</span><span style="color: #689f38;">'one'</span>, <span style="color: #689f38;">'one'</span>, <span style="color: #689f38;">'two'</span>, <span style="color: #689f38;">'three'</span>,
                          <span style="color: #689f38;">'two'</span>, <span style="color: #689f38;">'two'</span>, <span style="color: #689f38;">'one'</span>, <span style="color: #689f38;">'three'</span><span style="color: #EF6C00;">]</span>,
                   <span style="color: #689f38;">'C'</span> : np.random.randn<span style="color: #EF6C00;">(</span><span style="color: #689f38;">8</span><span style="color: #EF6C00;">)</span>,
                   <span style="color: #689f38;">'D'</span> : np.random.randn<span style="color: #EF6C00;">(</span><span style="color: #689f38;">8</span><span style="color: #EF6C00;">)</span><span style="color: #1565C0;">}</span><span style="color: #e91e63;">)</span>
gp
</pre>
</div>

<pre class="example">
     A      B         C         D
0  foo    one -0.720462  0.450766
1  bar    one -0.970592  0.532224
2  foo    two  0.095800  2.589090
3  bar  three -0.320740 -1.847557
4  foo    two -0.539154  2.315864
5  bar    two  0.798654 -0.344383
6  foo    one -0.452392 -0.302850
7  foo  three  0.500077 -0.207130
</pre>

</section>
<section id="slide-orgheadline20">
<h3 id="orgheadline20"></h3>
<div class="org-src-container">

<pre  class="src src-python">gp.groupby<span style="color: #e91e63;">(</span><span style="color: #689f38;">'A'</span><span style="color: #e91e63;">)</span>.<span style="color: #B71C1C;">sum</span><span style="color: #e91e63;">()</span>
</pre>
</div>

<pre class="example">
            C         D
A                      
bar -0.492679 -1.659716
foo -1.116131  4.845739
</pre>

<div class="org-src-container">

<pre  class="src src-python">gp.groupby<span style="color: #e91e63;">(</span><span style="color: #1565C0;">[</span><span style="color: #689f38;">'A'</span>,<span style="color: #689f38;">'B'</span><span style="color: #1565C0;">]</span><span style="color: #e91e63;">)</span>.mean<span style="color: #e91e63;">()</span>
</pre>
</div>

<pre class="example">
                  C         D
A   B                        
bar one   -0.970592  0.532224
    three -0.320740 -1.847557
    two    0.798654 -0.344383
foo one   -0.586427  0.073958
    three  0.500077 -0.207130
    two   -0.221677  2.452477
</pre>

</section>
<section id="slide-orgheadline21">
<h3 id="orgheadline21">Merging</h3>
<div class="org-src-container">

<pre  class="src src-python"><span style="color: #EF6C00;">left</span> = pd.DataFrame<span style="color: #e91e63;">(</span><span style="color: #1565C0;">{</span><span style="color: #689f38;">'key'</span>: <span style="color: #EF6C00;">[</span><span style="color: #689f38;">'one'</span>, <span style="color: #689f38;">'two'</span><span style="color: #EF6C00;">]</span>, <span style="color: #689f38;">'lval'</span>: <span style="color: #EF6C00;">[</span><span style="color: #689f38;">1</span>, <span style="color: #689f38;">2</span><span style="color: #EF6C00;">]</span><span style="color: #1565C0;">}</span><span style="color: #e91e63;">)</span>
<span style="color: #EF6C00;">right</span> = pd.DataFrame<span style="color: #e91e63;">(</span><span style="color: #1565C0;">{</span><span style="color: #689f38;">'key'</span>: <span style="color: #EF6C00;">[</span><span style="color: #689f38;">'two'</span>, <span style="color: #689f38;">'one'</span><span style="color: #EF6C00;">]</span>, <span style="color: #689f38;">'rval'</span>: <span style="color: #EF6C00;">[</span><span style="color: #689f38;">4</span>, <span style="color: #689f38;">5</span><span style="color: #EF6C00;">]</span><span style="color: #1565C0;">}</span><span style="color: #e91e63;">)</span>
pd.merge<span style="color: #e91e63;">(</span>left, right, on=<span style="color: #689f38;">'key'</span><span style="color: #e91e63;">)</span>
</pre>
</div>

<pre class="example">
   key  lval  rval
0  one     1     5
1  two     2     4
</pre>

</section>
<section id="slide-orgheadline22">
<h3 id="orgheadline22">Plotting</h3>
<p>
Pandas has built-in functions for common plot types
</p>
<div class="org-src-container">

<pre  class="src src-python"><span style="color: #00796b;">import</span> matplotlib.pyplot <span style="color: #00796b;">as</span> plt
<span style="color: #EF6C00;">df</span> = pd.DataFrame<span style="color: #e91e63;">(</span>randn<span style="color: #1565C0;">(</span><span style="color: #689f38;">1000</span>, <span style="color: #689f38;">4</span><span style="color: #1565C0;">)</span>, 
                  index=pd.date_range<span style="color: #1565C0;">(</span><span style="color: #689f38;">'1/1/2000'</span>, periods=<span style="color: #689f38;">1000</span><span style="color: #1565C0;">)</span>,
                  columns=<span style="color: #B71C1C;">list</span><span style="color: #1565C0;">(</span><span style="color: #689f38;">'ABCD'</span><span style="color: #1565C0;">)</span><span style="color: #e91e63;">)</span>
<span style="color: #EF6C00;">df</span> = df.cumsum<span style="color: #e91e63;">()</span>
<span style="color: #EF6C00;">ax</span> = df.plot<span style="color: #e91e63;">()</span>
</pre>
</div>

</section>
<section id="slide-orgheadline23">
<h3 id="orgheadline23"></h3>

<div class="figure">
<p><img src="ts.png" alt="ts.png" />
</p>
</div>

</section>
<section id="slide-orgheadline34">
<h3 id="orgheadline34">Working with a dataset</h3>
<p>
Let's try working with the <a href="http://grouplens.org/datasets/movielens/">Movielens</a> 100k dataset
</p>
<ul>
<li>1000 Users</li>
<li>100,000 Ratings</li>
<li>1700 Movies</li>

</ul>

<p>
Extract the ml-100k.zip to a folder <code>ml-100k</code> in the same directory as the <code>lecture7.py</code>
</p>

</section>
<section id="slide-orgheadline24">
<h4 id="orgheadline24">Reading the data</h4>
<div class="org-src-container">

<pre  class="src src-python"><span style="color: #607d8b;"># </span><span style="color: #607d8b;">pass in column names for each CSV</span>
<span style="color: #EF6C00;">u_cols</span> = <span style="color: #e91e63;">[</span><span style="color: #689f38;">'user_id'</span>, <span style="color: #689f38;">'age'</span>, <span style="color: #689f38;">'sex'</span>, <span style="color: #689f38;">'occupation'</span>, <span style="color: #689f38;">'zip_code'</span><span style="color: #e91e63;">]</span>
<span style="color: #EF6C00;">users</span> = pd.read_csv<span style="color: #e91e63;">(</span><span style="color: #689f38;">'ml-100k/u.user'</span>, sep=<span style="color: #689f38;">'|'</span>, names=u_cols,
                    encoding=<span style="color: #689f38;">"latin-1"</span><span style="color: #e91e63;">)</span>

<span style="color: #EF6C00;">r_cols</span> = <span style="color: #e91e63;">[</span><span style="color: #689f38;">'user_id'</span>, <span style="color: #689f38;">'movie_id'</span>, <span style="color: #689f38;">'rating'</span>, <span style="color: #689f38;">'unix_timestamp'</span><span style="color: #e91e63;">]</span>
<span style="color: #EF6C00;">ratings</span> = pd.read_csv<span style="color: #e91e63;">(</span><span style="color: #689f38;">'ml-100k/u.data'</span>, sep=<span style="color: #689f38;">'\t'</span>, names=r_cols,
                      encoding=<span style="color: #689f38;">"latin-1"</span><span style="color: #e91e63;">)</span>

<span style="color: #607d8b;"># </span><span style="color: #607d8b;">the movies file contains columns indicating the movie's genres</span>
<span style="color: #607d8b;"># </span><span style="color: #607d8b;">let's only load the first five columns of the file with usecols</span>
<span style="color: #EF6C00;">m_cols</span> = <span style="color: #e91e63;">[</span><span style="color: #689f38;">'movie_id'</span>, <span style="color: #689f38;">'title'</span>, <span style="color: #689f38;">'release_date'</span>,
          <span style="color: #689f38;">'video_release_date'</span>, <span style="color: #689f38;">'imdb_url'</span><span style="color: #e91e63;">]</span>
<span style="color: #EF6C00;">movies</span> = pd.read_csv<span style="color: #e91e63;">(</span><span style="color: #689f38;">'ml-100k/u.item'</span>, sep=<span style="color: #689f38;">'|'</span>, 
                     names=m_cols, usecols=<span style="color: #B71C1C;">range</span><span style="color: #1565C0;">(</span><span style="color: #689f38;">5</span><span style="color: #1565C0;">)</span>,
                     encoding=<span style="color: #689f38;">'latin-1'</span><span style="color: #e91e63;">)</span>

<span style="color: #607d8b;"># </span><span style="color: #607d8b;">create one merged DataFrame</span>
<span style="color: #EF6C00;">movie_ratings</span> = pd.merge<span style="color: #e91e63;">(</span>movies, ratings<span style="color: #e91e63;">)</span>
<span style="color: #EF6C00;">lens</span> = pd.merge<span style="color: #e91e63;">(</span>movie_ratings, users<span style="color: #e91e63;">)</span>
</pre>
</div>

</section>
<section id="slide-orgheadline25">
<h4 id="orgheadline25">What did we read?</h4>
<div class="org-src-container">

<pre  class="src src-python">lens.head<span style="color: #e91e63;">(</span><span style="color: #689f38;">3</span><span style="color: #e91e63;">)</span>
</pre>
</div>

<pre class="example">
   movie_id              title release_date  video_release_date  \
0         1   Toy Story (1995)  01-Jan-1995                 NaN   
1         4  Get Shorty (1995)  01-Jan-1995                 NaN   
2         5     Copycat (1995)  01-Jan-1995                 NaN   

                                            imdb_url  user_id  rating  \
0  http://us.imdb.com/M/title-exact?Toy%20Story%2...      308       4   
1  http://us.imdb.com/M/title-exact?Get%20Shorty%...      308       5   
2  http://us.imdb.com/M/title-exact?Copycat%20(1995)      308       4   

   unix_timestamp  age sex occupation zip_code  
0       887736532   60   M    retired    95076  
1       887737890   60   M    retired    95076  
2       887739608   60   M    retired    95076
</pre>

</section>
<section id="slide-orgheadline26">
<h4 id="orgheadline26">What are the 10 most rated movies?</h4>
<div class="org-src-container">

<pre  class="src src-python"><span style="color: #EF6C00;">most_rated</span> = lens.groupby<span style="color: #e91e63;">(</span><span style="color: #689f38;">'title'</span><span style="color: #e91e63;">)</span>.size<span style="color: #e91e63;">()</span>.sort_values<span style="color: #e91e63;">(</span>ascending=<span style="color: #558b2f;">False</span><span style="color: #e91e63;">)[</span>:<span style="color: #689f38;">10</span><span style="color: #e91e63;">]</span>
<span style="color: #00796b;">print</span><span style="color: #e91e63;">(</span>most_rated<span style="color: #e91e63;">)</span>
</pre>
</div>

<pre class="example">
title
Star Wars (1977)                 583
Contact (1997)                   509
Fargo (1996)                     508
Return of the Jedi (1983)        507
Liar Liar (1997)                 485
English Patient, The (1996)      481
Scream (1996)                    478
Toy Story (1995)                 452
Air Force One (1997)             431
Independence Day (ID4) (1996)    429
dtype: int64
</pre>

</section>
<section id="slide-orgheadline27">
<h4 id="orgheadline27">Which movies are most highly rated?</h4>
<p>
The <code>agg</code> function can take multiple functions that are applied to a column 
</p>
<div class="org-src-container">

<pre  class="src src-python"><span style="color: #EF6C00;">movie_stats</span> = lens.groupby<span style="color: #e91e63;">(</span><span style="color: #689f38;">'title'</span><span style="color: #e91e63;">)</span>.agg<span style="color: #e91e63;">(</span><span style="color: #1565C0;">{</span><span style="color: #689f38;">'rating'</span>: <span style="color: #EF6C00;">[</span>np.size, np.mean<span style="color: #EF6C00;">]</span><span style="color: #1565C0;">}</span><span style="color: #e91e63;">)</span>
movie_stats.head<span style="color: #e91e63;">()</span>
</pre>
</div>

<pre class="example">
                          rating          
                            size      mean
title                                     
'Til There Was You (1997)      9  2.333333
1-900 (1994)                   5  2.600000
101 Dalmatians (1996)        109  2.908257
12 Angry Men (1957)          125  4.344000
187 (1997)                    41  3.024390
</pre>

</section>
<section id="slide-orgheadline28">
<h4 id="orgheadline28">Which movies are most highly rated?</h4>
<p>
Sort them by mean rating
</p>
<div class="org-src-container">

<pre  class="src src-python">movie_stats.sort<span style="color: #e91e63;">(</span><span style="color: #1565C0;">[</span><span style="color: #EF6C00;">(</span><span style="color: #689f38;">'rating'</span>, <span style="color: #689f38;">'mean'</span><span style="color: #EF6C00;">)</span><span style="color: #1565C0;">]</span>, ascending=<span style="color: #558b2f;">False</span><span style="color: #e91e63;">)</span>.head<span style="color: #e91e63;">()</span>
</pre>
</div>

<pre class="example">
                                           rating     
                                             size mean
title                                                 
They Made Me a Criminal (1939)                  1    5
Marlene Dietrich: Shadow and Light (1996)       1    5
Saint of Fort Washington, The (1993)            2    5
Someone Else's America (1995)                   1    5
Star Kid (1997)                                 3    5
</pre>

</section>
<section id="slide-orgheadline29">
<h4 id="orgheadline29">Which movies are most highly rated?</h4>
<p>
Lets only look at movies rated at least 100 times
</p>
<div class="org-src-container">

<pre  class="src src-python"><span style="color: #EF6C00;">atleast_100</span> = movie_stats<span style="color: #e91e63;">[</span><span style="color: #689f38;">'rating'</span><span style="color: #e91e63;">][</span><span style="color: #689f38;">'size'</span><span style="color: #e91e63;">]</span> &gt;= <span style="color: #689f38;">100</span>
movie_stats<span style="color: #e91e63;">[</span>atleast_100<span style="color: #e91e63;">]</span>.sort<span style="color: #e91e63;">(</span><span style="color: #1565C0;">[</span><span style="color: #EF6C00;">(</span><span style="color: #689f38;">'rating'</span>, <span style="color: #689f38;">'mean'</span><span style="color: #EF6C00;">)</span><span style="color: #1565C0;">]</span>, ascending=<span style="color: #558b2f;">False</span><span style="color: #e91e63;">)</span>.head<span style="color: #e91e63;">()</span>
</pre>
</div>

<pre class="example">
                                 rating          
                                   size      mean
title                                            
Close Shave, A (1995)               112  4.491071
Schindler's List (1993)             298  4.466443
Wrong Trousers, The (1993)          118  4.466102
Casablanca (1942)                   243  4.456790
Shawshank Redemption, The (1994)    283  4.445230
</pre>

</section>
<section id="slide-orgheadline30">
<h4 id="orgheadline30">Exercise</h4>
<div class="org-src-container">

<pre  class="src src-python"><span style="color: #607d8b;">### </span><span style="color: #607d8b;">Exercise ###</span>
<span style="color: #607d8b;">### </span><span style="color: #607d8b;">Try to plot the ratings distribution of a movie of your choice.</span>
<span style="color: #607d8b;">### </span><span style="color: #607d8b;">you can use the hist() function to produce a histogram</span>
</pre>
</div>

</section>
<section id="slide-orgheadline31">
<h4 id="orgheadline31">Solution</h4>
<div class="org-src-container">

<pre  class="src src-python"><span style="color: #EF6C00;">toy_story</span> = lens<span style="color: #e91e63;">[</span>lens.title==<span style="color: #689f38;">'Toy Story (1995)'</span><span style="color: #e91e63;">]</span>
plt.figure<span style="color: #e91e63;">()</span>
<span style="color: #EF6C00;">ax</span> = toy_story.rating.hist<span style="color: #e91e63;">()</span>
plt.savefig<span style="color: #e91e63;">(</span><span style="color: #689f38;">'hist.png'</span><span style="color: #e91e63;">)</span>
<span style="color: #689f38;">'hist.png'</span>
</pre>
</div>


<div class="figure">
<p><img src="hist.png" alt="hist.png" width="50%" />
</p>
</div>

</section>
<section id="slide-orgheadline32">
<h4 id="orgheadline32">Exercise 2</h4>
<div class="org-src-container">

<pre  class="src src-python"><span style="color: #607d8b;">### </span><span style="color: #607d8b;">Exercise ###</span>
<span style="color: #607d8b;">### </span><span style="color: #607d8b;">plot the mean rating by age of user</span>
</pre>
</div>

</section>
<section id="slide-orgheadline33">
<h4 id="orgheadline33">Solution</h4>
<div class="org-src-container">

<pre  class="src src-python"><span style="color: #EF6C00;">age_grouped</span> = toy_story.groupby<span style="color: #e91e63;">(</span><span style="color: #689f38;">'age'</span><span style="color: #e91e63;">)</span>.mean<span style="color: #e91e63;">()</span>
plt.figure<span style="color: #e91e63;">()</span>
<span style="color: #EF6C00;">ax</span> = age_grouped<span style="color: #e91e63;">[</span><span style="color: #689f38;">'rating'</span><span style="color: #e91e63;">]</span>.plot<span style="color: #e91e63;">()</span>
plt.savefig<span style="color: #e91e63;">(</span><span style="color: #689f38;">'age-ratings.png'</span><span style="color: #e91e63;">)</span>
<span style="color: #689f38;">'age-ratings.png'</span>
</pre>
</div>


<div class="figure">
<p><img src="age-ratings.png" alt="age-ratings.png" width="50%" />
</p>
</div>
</section>
</section>
<section>
<section id="slide-orgheadline36">
<h2 id="orgheadline36">Additional Resources</h2>
<ul>
<li><a href="http://pandas.pydata.org/">Pandas website</a> - The documentation is very thorough and full of examples</li>
<li><a href="http://pandas.pydata.org/pandas-docs/stable/tutorials.html">List of pandas tutorials</a></li>
<li><a href="http://www.gregreda.com/2013/10/26/using-pandas-on-the-movielens-dataset/">using pandas on the movielens dataset</a> (blogpost from which I took some examples)</li>

</ul>
</section>
</section>
</div>
</div>

<script src="../reveal.js/lib/js/head.min.js"></script>
<script src="../reveal.js/js/reveal.js"></script>

<script>
// Full list of configuration options available here:
// https://github.com/hakimel/reveal.js#configuration
Reveal.initialize({

controls: true,
progress: true,
history: false,
center: true,
slideNumber: true,
rollingLinks: false,
keyboard: true,
overview: true,

theme: Reveal.getQueryHash().theme, // available themes are in /css/theme
transition: Reveal.getQueryHash().transition || 'default', // default/cube/page/concave/zoom/linear/fade/none
transitionSpeed: 'default',
multiplex: {
    secret: '', // null if client
    id: '', // id, obtained from socket.io server
    url: '' // Location of socket.io server
},

// Optional libraries used to extend on reveal.js
dependencies: [

]
});
</script>
</body>
</html>
